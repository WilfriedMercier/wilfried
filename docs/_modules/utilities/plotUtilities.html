
<!DOCTYPE html>

<html lang="en">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<title>utilities.plotUtilities | wilfried library 1.0 documentation</title>
<link href="../../_static/pygments.css" rel="stylesheet"/>
<link href="../../_static/theme.313ea551d1799b2102b1.css" rel="stylesheet"/>
<link href="../../_static/plot_directive.css" rel="stylesheet"/>
<link href="../../_static/copybutton.css" rel="stylesheet"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../../genindex.html" rel="index" title="Index"/>
</head>
<body class="antialiased text-gray">
<div class="h-screen xl:grid xl:grid-layout" data-action="keydown@window-&gt;search#focus" data-controller="sidebar search" id="page">
<a class="block text-xl bg-white py-4 z-20 absolute top-0 h-18 inset-x-0 text-center transform -translate-y-full focus:translate-y-0 focus:outline-none transition-transform duration-75" href="#utilities-plotutilities" title="Skip navigation links">Skip to content</a>
<header class="grid-area-header z-10 h-14 sm:h-18">
<div class="bg-gray-dark shadow-md flex items-center h-full xl:px-2 relative"><div class="flex items-center">
<button class="xl:hidden h-14 w-14 sm:h-18 sm:w-18 leading-14 sm:leading-18 text-gray-100 hover:bg-gray-700 hover:text-brand focus:outline-none focus:bg-gray-700 focus:text-brand" data-action="sidebar#open" data-sidebar-target="hamburger">
<span class="sr-only">Open navigation menu</span>
<svg aria-hidden="true" class="fill-current h-8 w-8" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
</button><a aria-label="Back to homepage" class="hover:bg-gray-700 focus:bg-gray-700 focus:outline-none tooltipped tooltipped-sw" href="../../index.html"><span class="hidden lg:inline-block shrink-0 font-medium text-gray-100 mx-5 leading-14 sm:leading-18 tracking-wider">wilfried library 1.0 documentation</span>
</a></div><div class="flex justify-end items-center flex-1"><form action="../../search.html" class="flex print:hidden justify-between items-center leading-14 sm:leading-18 md:ml-4 bg-gray-dark text-gray-300 focus-within:bg-gray-50 focus-within:text-gray-800 focus-within:absolute focus-within:inset-x-0 focus-within:top-0 md:focus-within:w-full md:focus-within:static" data-action="click-&gt;search#focusSearchInput" id="searchbox" method="get">
<button aria-label="Get search results" class="text-inherit h-14 w-14 sm:h-18 sm:w-18" tabindex="-1">
<svg aria-hidden="true" class="fill-current stroke-current h-8 w-8" stroke-width="0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
</button>
<input aria-label="Search the docs" class="pr-2 bg-transparent text-inherit focus:outline-none w-0 md:w-auto focus:w-full transition-all duration-100" data-search-target="searchInput" id="search-input" name="q" placeholder="Search the docs" type="search"/>
</form></div>
</div>
</header>
<aside class="grid-area-sidebar h-full fixed xl:relative inset-y-0 left-0 z-20 xl:z-0 print:hidden overflow-y-auto transition-all transform transform-gpu -translate-x-full opacity-0 duration-300 xl:translate-x-0 xl:opacity-100" data-sidebar-target="sidebar">
<nav class="h-full overflow-y-auto bg-white text-gray-600 pt-8 flex flex-col" role="navigation">
<div class="nav-toc flex-1 pl-6"><ul>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../dependencies.html">Required dependencies</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../makeLifeSimpler.html">makeLifeSimpler</a></div></li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/index.html">Useful utilities</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/coloredMessages.html">Colored messages</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/coloredMessages.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/coloredMessages.html#example">Example</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/coloredMessages.html#module-utilities.coloredMessages">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/dict.html">Dictionaries</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/dict.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/dict.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/dict.html#module-utilities.dictionaries">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/io.html">Input/Output</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/io.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/io.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/io.html#module-utilities.io">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/list.html">List manipulations</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/list.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/list.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/list.html#module-utilities.lists">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/strings.html">Strings manipulation</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/strings.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/strings.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/strings.html#module-utilities.strings">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/plotUtilities/index.html">Plot utilities</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/plotUtilities/asManyHists.html">Histograms</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/plotUtilities/hst.html">Galfit related plots</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/plotUtilities/misc.html">Miscellaneous</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../utilities/plotUtilities/singleContour.html">Contours</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/index.html">Galaxy module</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/angularMomentum.html">Galaxies angular momentum</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/cosmology.html">Cosmology computations</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/geometry.html">Galaxies angular momentum</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/kinematics.html">Galaxy kinematics</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/misc.html">Miscellaneous</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/massModels.html">Galaxy mass models</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/models.html">Galaxy models</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/models.html#d-profiles">1D profiles</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/models.html#id1">2D profiles</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/morphology/index.html">Galaxies morphology</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/morphology/index.html#functions-are-split-into-the-following-modules">Functions are split into the following modules:</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/photometry/index.html">Galaxies photometry</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galaxy/photometry/index.html#functions-are-split-into-the-following-modules">Functions are split into the following modules:</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galfit/index.html">Galfit module</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galfit/galfit.html">Galfit auto-routines</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galfit/models.html">Galfit models</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galfit/models.html#miscellaneous">Miscellaneous</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galfit/models.html#galfit-profiles">Galfit profiles</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../../galfit/models.html#galfit-additional-tags">Galfit additional tags</a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<button class="text-4xl text-gray-800 p-4 bottom-0 hover:text-brand xl:hidden focus:text-brand self-center" data-action="" title="Close navigation menu">
<span class="sr-only">Close navigation menu</span>
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</aside>
<main class="px-10 xl:ml-fluid grid-area-main overflow-y-auto flex flex-col h-full mx-0 md:mx-auto xl:mr-0" data-action="scroll-&gt;scroll#showButton" data-controller="scroll"><nav aria-label="breadcrumbs" class="print:hidden mt-12 text-sm text-gray-light" role="navigation">
<a class="text-gray-light text-sm hover:text-gray-dark font-medium focus:text-gray-dark" href="../../index.html">wilfried library 1.0 documentation</a>
<span class="mr-1">/</span><a class="text-gray-light text-sm hover:text-gray-dark" href="../index.html">Module code</a>
<span class="mr-1">/</span><span aria-current="page">utilities.plotUtilities</span>
</nav>
<article class="flex-1" role="main">
<h1>Source code for utilities.plotUtilities</h1><div class="highlight"><pre>
<code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">"""</span>
<span class="sd">.. codeauthor:: Wilfried Mercier - IRAP &lt;wilfried.mercier@irap.omp.eu&gt;</span>

<span class="sd">With the help of Lina Issa - IRAP</span>

<span class="sd">Functions meant to automatise as much as possible plotting of data of any kind.</span>
<span class="sd">"""</span>

<span class="kn">import</span> <span class="nn">numpy</span>                              <span class="k">as</span>     <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>                  <span class="k">as</span>     <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.gridspec</span>                <span class="k">as</span>     <span class="nn">gridspec</span>
<span class="kn">import</span> <span class="nn">astropy.io.fits</span>                    <span class="k">as</span>     <span class="nn">fits</span>
<span class="kn">from</span>   <span class="nn">matplotlib.colors</span>                  <span class="kn">import</span> <span class="n">Normalize</span><span class="p">,</span> <span class="n">LogNorm</span><span class="p">,</span> <span class="n">SymLogNorm</span><span class="p">,</span> <span class="n">PowerNorm</span><span class="p">,</span> <span class="n">TwoSlopeNorm</span><span class="p">,</span> <span class="n">BoundaryNorm</span>
<span class="kn">from</span>   <span class="nn">astropy.modeling.functional_models</span> <span class="kn">import</span> <span class="n">Gaussian2D</span>
<span class="kn">from</span>   <span class="nn">matplotlib.markers</span>                 <span class="kn">import</span> <span class="n">MarkerStyle</span>
<span class="kn">from</span>   <span class="nn">copy</span>                               <span class="kn">import</span> <span class="n">copy</span>
<span class="kn">from</span>   <span class="nn">os.path</span>                            <span class="kn">import</span> <span class="n">isfile</span>


<span class="c1">################################################################################################</span>
<span class="c1">#                                   Galfit models plots                                        #</span>
<span class="c1">################################################################################################</span>


<div class="viewcode-block" id="display_hst_models"><a class="viewcode-back" href="../../utilities/plotUtilities/hst.html#utilities.plotUtilities.display_hst_models">[docs]</a><span class="k">def</span> <span class="nf">display_hst_models</span><span class="p">(</span><span class="n">file1</span><span class="p">,</span> <span class="n">fileout</span><span class="o">=</span><span class="s1">'test.pdf'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'spectral'</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    .. codeauthor:: Epinat Benoit - LAM &lt;benoit.epinat@lam.fr&gt; &amp; Wilfried Mercier - IRAP &lt;wilfried.mercier@irap.omp.eu&gt;</span>
<span class="sd">    </span>
<span class="sd">    This function enables to display a GALFIT output file containing the galaxy image, the associated model and the residuals.</span>
<span class="sd">    </span>
<span class="sd">    :param str file1: name of GALFIT output file</span>
<span class="sd">        </span>
<span class="sd">    :param str cmap: (**Optional**) name of the colormap. Must be understood by matplotlib.</span>
<span class="sd">    :param str fileout: (**Optional**) name of the output file</span>
<span class="sd">    :param bool log: (**Optional**) whether to have a log scale or not</span>
<span class="sd">    :param bool show: (**Optional**) whether to show the image or not</span>
<span class="sd">    :param str title: (**Optional**) title of the output image</span>
<span class="sd">    </span>
<span class="sd">    :raises TypeError:</span>
<span class="sd">        </span>
<span class="sd">        * if **title** is neither None, nor of type str</span>
<span class="sd">        * if **fileout** is not of type str</span>
<span class="sd">        * if **cmap** is not of type str</span>
<span class="sd">        * if **log** is not of type bool</span>
<span class="sd">        * if **show** is not of type bool</span>
<span class="sd">    '''</span>
    
    <span class="c1"># Perform checks</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'title is of type </span><span class="si">%s</span><span class="s1"> but it must be a string.'</span> <span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fileout</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'fileout is of type </span><span class="si">%s</span><span class="s1"> but it must be a string.'</span> <span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">fileout</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'cmap is of type </span><span class="si">%s</span><span class="s1"> but it must be a string.'</span> <span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">cmap</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'log is of type </span><span class="si">%s</span><span class="s1"> but it must be a bool.'</span> <span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">log</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'show is of type </span><span class="si">%s</span><span class="s1"> but it must be a bool.'</span> <span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">show</span><span class="p">))</span>

    <span class="c1"># Load data    </span>
    <span class="n">hdul</span>     <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file1</span><span class="p">)</span>
    <span class="n">data</span>     <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">model</span>    <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">res</span>      <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># Generate figure</span>
    <span class="n">fig</span>      <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    
    <span class="n">maxi</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">]))])</span>
    <span class="n">mini</span>     <span class="o">=</span> <span class="o">-</span><span class="n">maxi</span>
    
    <span class="n">norm</span>     <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
        <span class="n">norm</span> <span class="o">=</span> <span class="n">SymLogNorm</span><span class="p">(</span><span class="n">linthresh</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
        
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> 
                         <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> 
                         <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
    <span class="n">maxi</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">res</span><span class="p">))])</span>
    <span class="n">mini</span>     <span class="o">=</span> <span class="o">-</span><span class="n">maxi</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fileout</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="genMeThatPDF"><a class="viewcode-back" href="../../utilities/plotUtilities/hst.html#utilities.plotUtilities.genMeThatPDF">[docs]</a><span class="k">def</span> <span class="nf">genMeThatPDF</span><span class="p">(</span><span class="n">fnamesList</span><span class="p">,</span> <span class="n">pdfOut</span><span class="p">,</span> <span class="n">readFromFile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">groupNumbers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">diverging</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">zeroPoint</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'bwr'</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    .. codeauthor:: Wilfried Mercier - IRAP &lt;wilfried.mercier@irap.omp.eu&gt;</span>
<span class="sd">    </span>
<span class="sd">    Generate a pdf file with all the GALFIT images (data, model and residual) side by side.</span>
<span class="sd">    </span>
<span class="sd">    .. note::</span>
<span class="sd">        </span>
<span class="sd">        When certain problems arise, a default blank plot is drawn instead. Below is a list of issues where a blank plot may be generated</span>
<span class="sd">            </span>
<span class="sd">            * if a file is not found</span>
<span class="sd">            * if the min and max of an image are equal</span>

<span class="sd">    :param list[str] fnamesList: all the file names (paths included) with the GALFIT images. If **readFromFile** is True, provide the name of a file containing all the different names (one per line).</span>
<span class="sd">    :param str pdfOut: name of the output pdf file</span>
<span class="sd">        </span>
<span class="sd">    :param bool diverging: (**Optional**) whether to use a diverging norm or not. If False, a linear norm will be used (overriding any log norm).</span>
<span class="sd">    :param str cmap: (**Optional**) colormap to use for the plot</span>
<span class="sd">    :param list[str] groupNumbers: (**Optional**) list of groups the galaxies belong to</span>
<span class="sd">    :param bool log: (**Optional**) whether to show images as log or not</span>
<span class="sd">    :param bool readFromFile: (**Optional**) whether to read the file names from a file or not. If True, the names must be listed one per line.</span>
<span class="sd">    :param float zeroPoint: (**Optional**) value at which the diverging norm will split in two</span>
<span class="sd">    """</span>
    
    <span class="k">def</span> <span class="nf">noModelAvailable</span><span class="p">():</span>
        <span class="sd">'''Generate default values when no model is available for the plot'''</span>
        
        <span class="n">sz</span>        <span class="o">=</span> <span class="mi">60</span>
        <span class="n">data</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">sz</span><span class="p">]</span><span class="o">*</span><span class="n">sz</span><span class="p">)</span>
        <span class="n">model</span>     <span class="o">=</span> <span class="n">data</span>
        <span class="n">res</span>       <span class="o">=</span> <span class="n">data</span>
        <span class="n">maxi</span>      <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mini</span>      <span class="o">=</span> <span class="mi">0</span>
        <span class="n">log</span>       <span class="o">=</span> <span class="kc">False</span>
        <span class="n">diverging</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cmap</span>      <span class="o">=</span> <span class="s1">'Greys_r'</span>
        <span class="n">norm</span>      <span class="o">=</span> <span class="n">BoundaryNorm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">noFile</span>    <span class="o">=</span> <span class="kc">True</span>
        
        <span class="k">return</span> <span class="n">sz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">diverging</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">noFile</span>
    
    <span class="c1"># Get file names from a file if necessary</span>
    <span class="k">if</span> <span class="n">readFromFile</span><span class="p">:</span>
        <span class="n">fnamesList</span><span class="p">,</span> <span class="n">groupNumbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fnamesList</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Computing the number of necessary subfigures</span>
    <span class="n">nbfig</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fnamesList</span><span class="p">)</span>
    
    <span class="c1"># Stripping path from file names</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">fnamesList</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fnamesList</span><span class="p">):</span>
        <span class="n">names</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Creating default values if group numbers are not given</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">groupNumbers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">groupNumbers</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fnamesList</span><span class="p">)):</span>
        <span class="n">groupNumbers</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">nbfig</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">nbfig</span><span class="p">))</span>
    <span class="n">gs</span>  <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">nbfig</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
    
    <span class="n">cmapSave</span>       <span class="o">=</span> <span class="n">cmap</span>
    <span class="n">previousNumber</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">gr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">nbfig</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">fnamesList</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">groupNumbers</span><span class="p">):</span>
        
        <span class="c1"># Re-initialise the color map if it was changed</span>
        <span class="n">cmap</span>           <span class="o">=</span> <span class="n">cmapSave</span>
        
        <span class="c1"># Fetching fits file extensions with data, model and residual maps</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">hdul</span>       <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">data</span>       <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">sz</span>         <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">'NAXIS2'</span><span class="p">])</span>
            <span class="n">model</span>      <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">res</span>        <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            
            <span class="c1"># Defining a maximum and minimum which are symetrical</span>
            <span class="n">maxi</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">]))])</span>
            <span class="n">mini</span>       <span class="o">=</span> <span class="o">-</span><span class="n">maxi</span>
            <span class="n">norm</span>       <span class="o">=</span> <span class="kc">None</span>
            <span class="n">noFile</span>     <span class="o">=</span> <span class="kc">False</span>
            
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="c1"># If no file can be found (Galfit failed to model), we generate a default image to place on the plots</span>
            <span class="n">sz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">diverging</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">noFile</span> <span class="o">=</span> <span class="n">noModelAvailable</span><span class="p">()</span>
        
        <span class="c1"># Defining norm based on input parameter value</span>
        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">norm</span>   <span class="o">=</span> <span class="n">SymLogNorm</span><span class="p">(</span><span class="n">linthresh</span><span class="o">=</span><span class="n">maxi</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">diverging</span><span class="p">:</span>
            <span class="n">mini</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">])</span>
            <span class="n">maxi</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">])</span>
            
            <span class="k">if</span> <span class="n">mini</span> <span class="o">==</span> <span class="n">maxi</span><span class="p">:</span>
                <span class="n">sz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">diverging</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">noFile</span> <span class="o">=</span> <span class="n">noModelAvailable</span><span class="p">()</span> 
            <span class="k">elif</span> <span class="n">mini</span> <span class="o">==</span> <span class="n">zeroPoint</span><span class="p">:</span>
                <span class="n">mini</span> <span class="o">=</span> <span class="o">-</span> <span class="n">maxi</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="n">zeroPoint</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">maxi</span> <span class="o">==</span> <span class="n">zeroPoint</span><span class="p">:</span>
                <span class="n">maxi</span> <span class="o">=</span> <span class="o">-</span><span class="n">mini</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="n">zeroPoint</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
        
        <span class="c1"># Plotting the three plots side by side</span>
        <span class="n">ax1</span>        <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">num</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">noFile</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
        
        <span class="c1"># Adding group info on the plots if a new group is encountered</span>
        <span class="k">if</span> <span class="n">previousNumber</span> <span class="o">!=</span> <span class="n">gr</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"group"</span><span class="p">,</span> <span class="n">gr</span><span class="p">)</span>
            <span class="n">previousNumber</span> <span class="o">=</span> <span class="n">gr</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sz</span><span class="o">+</span><span class="mi">30</span><span class="p">,</span> <span class="s2">"Group: </span><span class="si">%s</span><span class="s2">"</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">gr</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
        
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">'model'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">noFile</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
        
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">num</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">'residual'</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">noFile</span><span class="p">:</span>
            <span class="n">maxi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            <span class="n">mini</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">mini</span> <span class="o">==</span> <span class="n">maxi</span><span class="p">:</span>
                <span class="n">sz</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">diverging</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">noFile</span> <span class="o">=</span> <span class="n">noModelAvailable</span><span class="p">()</span> 
            <span class="k">elif</span> <span class="n">mini</span> <span class="o">==</span> <span class="n">zeroPoint</span><span class="p">:</span>
                <span class="n">mini</span> <span class="o">=</span> <span class="o">-</span> <span class="n">maxi</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="n">zeroPoint</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">maxi</span> <span class="o">==</span> <span class="n">zeroPoint</span><span class="p">:</span>
                <span class="n">maxi</span> <span class="o">=</span> <span class="o">-</span><span class="n">mini</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="n">zeroPoint</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">)</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">mini</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxi</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">noFile</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdfOut</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">'tight'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
    

<span class="c1">#########################################################################</span>
<span class="c1">#                    Automated plotting utilities                       #</span>
<span class="c1">#########################################################################</span>
    
<div class="viewcode-block" id="effective_local_density"><a class="viewcode-back" href="../../utilities/plotUtilities/misc.html#utilities.plotUtilities.effective_local_density">[docs]</a><span class="k">def</span> <span class="nf">effective_local_density</span><span class="p">(</span><span class="n">numPlot</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">'''</span>
<span class="sd">    .. codeauthor:: Wilfried Mercier - IRAP &lt;wilfried.mercier@irap.omp.eu&gt;</span>
<span class="sd">    </span>
<span class="sd">    Generate an effective local density plot. </span>
<span class="sd">    </span>
<span class="sd">    The idea is that, given a set of measurements for which we have values of the data points scatter in X and Y, rather than just plotting those values with error bars, we can instead try to compute the "likelihood" of having data points in a particular location.</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    .. rubric:: **Information**</span>
<span class="sd">    </span>
<span class="sd">    The "likelihood" is represented as an effective 2D density:</span>
<span class="sd">    </span>
<span class="sd">        * If we are located infinitely far away from the bulk of the points, then we expect the density to drop to 0.</span>
<span class="sd">        * On the other hand, if all the measurements are located at the same location with 0 error assigned to them, then we expect to have a density maximised as N/box size of a point.</span>
<span class="sd">    </span>
<span class="sd">    This gives an idea of how clustered along a certain relation the points could be given their error bars.</span>
<span class="sd">    </span>
<span class="sd">    But, error bars are only indicators of how "wrong" the measurement could be. They do not strictly show the lower and upper bounds of the measurement. </span>
<span class="sd">    </span>
<span class="sd">    Error bars are sometimes represented as a 1 sigma width of a Gaussian distribution centered at that measurement location. Thus, we are assuming that this is the case here.</span>


<span class="sd">    .. warning::</span>
<span class="sd">        </span>
<span class="sd">        This is purely experimental.</span>

<span class="sd">    :param numPlot: plot identifier. It can be </span>
<span class="sd">    </span>
<span class="sd">        * an int (format is XYZ with X the number of rows, Y the number of columns and Z the plot position)</span>
<span class="sd">        * a list with 3 similar numbers [X, Y, Z]</span>
<span class="sd">        * a matplotlib GridSpec instance</span>
<span class="sd">        </span>
<span class="sd">    :type numPlot: list[3 int] or ndarray[3 int] or int or matplotlib GridSpec instance</span>
<span class="sd">    :param X: X position of the data points</span>
<span class="sd">    :type X: ndarray[int] or ndarray[float]</span>
<span class="sd">    :param xerr: X axis error on the data points</span>
<span class="sd">    :type xerr: ndarray[int] or ndarray[float]</span>
<span class="sd">    :param Y: y position of the data  points</span>
<span class="sd">    :type Y: ndarray[int] or ndarray[float]</span>
<span class="sd">    :param yerr: y axis error on the data points</span>
<span class="sd">    :type yerr: ndarray[int] or ndarray[float]</span>

<span class="sd">    :param dx: (**Optional**) x axis step used to draw the grid. If **nx** is provided, this parameter is overriden.</span>
<span class="sd">    :type dx: int or float</span>
<span class="sd">    :param dy: (**Optional**) y axis step used to draw the grid. If **ny** is provided, this parameters is overriden</span>
<span class="sd">    :type dy: int or floats</span>
<span class="sd">    :param int nx: (**Optional**) number of cells along the x axis. If None, **dx** is used instead to compute this value.</span>
<span class="sd">    :param int ny: (**Optional**) number of cells along the y axis. If None, **dy** is used instead to compute this value.</span>
<span class="sd">    :param xmin: (**Optional**) minimum x axis value for the x axis of the plot. If None, data points values will be used as bound.</span>
<span class="sd">    :type xmin: int or float</span>
<span class="sd">    :param xmax: (**Optional**) maximum x axis value for the x axis of the plot. If None, data points values will be used as bound.</span>
<span class="sd">    :type xmax: int or float</span>
<span class="sd">    :param ymin: (**Optional**) minimum y axis value for the y axis of the plot. If None, data points values will be used as bound.</span>
<span class="sd">    :type ymin: int or float</span>
<span class="sd">    :param ymax: (**Optional**) maximum y axis value for the y axis of the plot. If None, data points values will be used as bound.</span>
<span class="sd">    :type ymax: int or float</span>
<span class="sd">        </span>
<span class="sd">    :returns: matplotlib main axis</span>
<span class="sd">    :raises TypeError: if neither **X**, **Y**, **xerr** nor **yerr** is of type ndarray</span>
<span class="sd">    :raises ValueError: if either **xmin**, **xmax**, **ymin** or **ymax** is nan</span>
<span class="sd">    '''</span>
    
    <span class="c1"># Generate subplot</span>
    <span class="n">typ</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">numPlot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numPlot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">numPlot</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'One of the mandatory parameters is type </span><span class="si">%s</span><span class="s1"> but mandatory parameters must be numpy arrays only. Cheers !'</span> <span class="o">%</span><span class="nb">type</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="n">xmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xmin</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xmax</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ymin</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ymax</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="ow">in</span> <span class="p">[</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'One in xmin, xmax, ymin, ymax is nan, which may be due to having an array full of np.nan. Please check your arrays. Cheers !'</span><span class="p">)</span>
        
    <span class="c1"># Add a small error on data if error is 0 or np.nan, otherwise the Gaussian becomes a Dirac</span>
    <span class="n">xerr0</span>   <span class="o">=</span> <span class="n">xerr</span><span class="o">==</span><span class="mi">0</span>
    <span class="n">yerr0</span>   <span class="o">=</span> <span class="n">yerr</span><span class="o">==</span><span class="mi">0</span>
    <span class="n">xerrnan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">xerr</span><span class="p">)</span>
    <span class="n">yerrnan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">yerr</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">xerr0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">xerrnan</span><span class="p">):</span>
        <span class="n">xerr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">xerr0</span><span class="p">,</span> <span class="n">xerrnan</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">xerr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">~</span><span class="n">xerrnan</span><span class="p">,</span> <span class="o">~</span><span class="n">xerr0</span><span class="p">)])</span>

    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">yerr0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">yerrnan</span><span class="p">):</span>
        <span class="n">yerr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">yerr0</span><span class="p">,</span> <span class="n">yerrnan</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">yerr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">~</span><span class="n">yerrnan</span><span class="p">,</span> <span class="o">~</span><span class="n">yerr0</span><span class="p">)])</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Minimum errors are </span><span class="si">%s</span><span class="s1"> and </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">xerr</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">yerr</span><span class="p">)))</span>
    
    <span class="c1"># Generate the Gaussians</span>
    <span class="n">gaussians</span> <span class="o">=</span> <span class="p">[</span><span class="n">Gaussian2D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x_mean</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y_mean</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">x_stddev</span><span class="o">=</span><span class="n">xe</span><span class="p">,</span> <span class="n">y_stddev</span><span class="o">=</span><span class="n">ye</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">ye</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">)]</span>
        
    <span class="c1"># Generate the grid</span>
    <span class="k">if</span> <span class="n">nx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nx</span>    <span class="o">=</span> <span class="p">(</span><span class="n">xmax</span> <span class="o">-</span> <span class="n">xmin</span><span class="p">)</span><span class="o">//</span><span class="n">dx</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">ny</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ny</span>    <span class="o">=</span> <span class="p">(</span><span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span><span class="p">)</span><span class="o">//</span><span class="n">dy</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="n">xarr</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">yarr</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
    
    <span class="n">XX</span><span class="p">,</span> <span class="n">YY</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xarr</span><span class="p">,</span> <span class="n">yarr</span><span class="p">)</span>
    
    <span class="c1"># Compute the product of Gaussians at each grid point</span>
    <span class="n">ZZ</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">i</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gaussians</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">gaussians</span><span class="p">)</span>
    
    <span class="c1"># Compute the most likely path of Y given X</span>
    <span class="n">YgX_x</span><span class="p">,</span> <span class="n">YgX_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">z</span><span class="p">)]]</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">YY</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">T</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
    
    <span class="c1"># Compute the most likely path of X given Y</span>
    <span class="n">XgY_x</span><span class="p">,</span> <span class="n">XgY_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([[</span><span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">z</span><span class="p">)],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
    
    <span class="c1"># Plotting</span>
    <span class="n">ret</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">nx</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'hot'</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">col</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Probability'</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">YgX_x</span><span class="p">,</span> <span class="n">YgX_y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\lbrace (x,y) | y(x) = \max_Y ( Z(X=x, Y) ) \rbrace$'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">XgY_x</span><span class="p">,</span> <span class="n">XgY_y</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'magenta'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$\lbrace (x,y) | x(y) = \max_X ( Z(X, Y=y) ) \rbrace$'</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">ret</span></div>
    

<div class="viewcode-block" id="singleContour"><a class="viewcode-back" href="../../utilities/plotUtilities/singleContour.html#utilities.plotUtilities.singleContour">[docs]</a><span class="k">def</span> <span class="nf">singleContour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sizeFig</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'equal'</span><span class="p">,</span> <span class="n">hideAllTicks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">norm</span><span class="o">=</span><span class="s1">'log'</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="s1">'both'</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    .. codeauthor:: Wilfried Mercier - IRAP &lt;wilfried.mercier@irap.omp.eu&gt;</span>
<span class="sd">    </span>
<span class="sd">    Draw a (filled) contour plot.</span>

<span class="sd">    :param X: grid containing the x-axis values for each pixel</span>
<span class="sd">    :type X: meshgrid ndarray</span>
<span class="sd">    :param Y: grid containing the y-axis values for each pixel</span>
<span class="sd">    :type Y: meshgrid ndarray</span>
<span class="sd">    :param Z: grid containing the z-axis values for each pixel. This will correspond to the contour values.</span>
<span class="sd">    :type Z: meshgrid ndarray</span>
<span class="sd">    </span>
<span class="sd">    :param str aspect: (**Optional**) aspect of the plot</span>
<span class="sd">    :param str cmap: (**Optional**) colormap to use</span>
<span class="sd">    :param bool colorbar: (**Optional**) whether to draw a colorbar or not</span>
<span class="sd">    :param contours: (**Optional**) contours to draw </span>
<span class="sd">    </span>
<span class="sd">        * if an int, it must be the number of contours to draw</span>
<span class="sd">        * if a list, it must be the contour values </span>
<span class="sd">        * if None, its value will be determined automatically (see matplotlib)</span>
<span class="sd">        </span>
<span class="sd">    :type contours: int or list[int] or list[float]</span>
<span class="sd">    :param float cut: (**Optional**) cut below which values in the Z data are put to np.nan. If None, no cut is applied.</span>
<span class="sd">    :param filled: (**Optional**) whether to draw a filled contour (if True) or just contours (if False), or both (if "both")</span>
<span class="sd">    :type filled: bool or str</span>
<span class="sd">    :param bool hideAllTicks: (**Optional**) whether to hide ticks or not</span>
<span class="sd">    :param str norm: (**Optional**) scale to use. Must either be 'log' or 'linear'.</span>
<span class="sd">    :param sizeFig: (**Optional**) width and height of the figure</span>
<span class="sd">    :type sizeFig: (int, int)</span>
<span class="sd">    :param (float, float) xlim: (**Optional**) x-axis bounds. If None, the min and max of X are used.</span>
<span class="sd">    :param (float, float) ylim: (**Optional**) y-axis bounds. If None, the min and max of Y are used.</span>
<span class="sd">    </span>
<span class="sd">    :returns: current axis and plot</span>
<span class="sd">    </span>
<span class="sd">    :raises ValueError: if **norm** is neither 'linear', nor 'log'</span>
<span class="sd">    '''</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">"figure.figsize"</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizeFig</span>
    <span class="n">f</span>             <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span>            <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="n">aspect</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    
    <span class="n">Intensity</span>     <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Intensity</span><span class="p">[</span><span class="n">Intensity</span><span class="o">&lt;=</span><span class="n">cut</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    
    <span class="k">if</span> <span class="n">hideAllTicks</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labeltop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">'log'</span><span class="p">:</span>
        <span class="n">theNorm</span>   <span class="o">=</span> <span class="n">LogNorm</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">contours</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">Z</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">Z</span><span class="p">)),</span> <span class="n">num</span><span class="o">=</span><span class="n">contours</span><span class="p">)</span>
            
        <span class="n">levels</span>    <span class="o">=</span> <span class="n">contours</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">'linear'</span><span class="p">:</span>
        <span class="n">levels</span>    <span class="o">=</span> <span class="kc">None</span>
        <span class="n">theNorm</span>   <span class="o">=</span> <span class="n">Normalize</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Given norm is neither log nor linear. Please provide one of these options. Cheers !'</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filled</span> <span class="o">==</span> <span class="s1">'both'</span> <span class="ow">or</span> <span class="n">filled</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ret</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Intensity</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contours</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">theNorm</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filled</span> <span class="o">==</span> <span class="s1">'both'</span> <span class="ow">or</span> <span class="n">filled</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Intensity</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">'dashed'</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contours</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">theNorm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gist_yarg'</span><span class="p">)</span> <span class="c1">#colors='k'</span>
    
    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">xlim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        
    <span class="c1">#plt.show()</span>
    
    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="asManyHists"><a class="viewcode-back" href="../../utilities/plotUtilities/asManyHists.html#utilities.plotUtilities.asManyHists">[docs]</a><span class="k">def</span> <span class="nf">asManyHists</span><span class="p">(</span><span class="n">numPlot</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hideXlabel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hideYlabel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hideYticks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hideXticks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">placeYaxisOnRight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">textsize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">showLegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legendTextSize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">legendEdgeColor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">locLegend</span><span class="o">=</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">tickSize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">''</span><span class="p">,</span> <span class="n">titlesize</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                <span class="n">outputName</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tightLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">integralIsOne</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">align</span><span class="o">=</span><span class="s1">'mid'</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">'stepfilled'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">legendNcols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="sd">"""</span>
<span class="sd">    .. codeauthor:: Wilfried Mercier - IRAP &lt;wilfried.mercier@irap.omp.eu&gt;</span>
<span class="sd">    </span>
<span class="sd">    Function which plots on a highly configurable subplot grid 1D histograms. A list of data can be given to have multiple histograms on the same subplot.</span>

<span class="sd">    :param ndarray data: data to plot as histogram</span>
<span class="sd">    :param numPlot: plot identifier. It can be </span>
<span class="sd">    </span>
<span class="sd">        * an int (format is XYZ with X the number of rows, Y the number of columns and Z the plot position)</span>
<span class="sd">        * a list with 3 similar numbers [X, Y, Z]</span>
<span class="sd">        * a matplotlib GridSpec instance</span>
<span class="sd">        </span>
<span class="sd">    :type numPlot: list[3 int] or ndarray[3 int] or int or matplotlib GridSpec instance</span>

<span class="sd">    :param str align: (**Optional**) how to align bars with respect to their value. Must either be 'left', 'mid' or 'right'.</span>
<span class="sd">    :param float alpha: (**Optional**) transparency of the bars</span>
<span class="sd">    :param bins: (**Optional**) define the bins:</span>
<span class="sd">        </span>
<span class="sd">        * if an int, must be the number of bins</span>
<span class="sd">        * if a list, must be the bins edges</span>
<span class="sd">        </span>
<span class="sd">    :type bins: int or list[int]</span>
<span class="sd">    :param str color: (**Optional**) color for the data. It can either be a string or RGB values.</span>
<span class="sd">    :param bool cumulative: (**Optional**) whether to plot the cumulative distribution (where each bin equals the sum of the values in the previous bins up to this one)</span>
<span class="sd">    :param bool fancybox: (**Optional**) whether to draw a fancy legend or not</span>
<span class="sd">    :param float framealpha: (**Optional**) transparency the legend background</span>
<span class="sd">    :param bool frameon: (**Optional**) whether to draw the legend frame or not</span>
<span class="sd">    :param bool grid: (**Optional**) whether to show the grid or not</span>
<span class="sd">    :param str hatch: (**Optional**) hatching pattern</span>
<span class="sd">    :param bool hideXlabel: (**Optional**) whether to hide the x label or not</span>
<span class="sd">    :param bool hideXticks: (**Optional**) whether to hide the x ticks or not</span>
<span class="sd">    :param bool hideYlabel: (**Optional**) whether to hide the y label or not</span>
<span class="sd">    :param bool hideYticks: (**Optional**) whether to hide the y ticks or not</span>
<span class="sd">    :param str histtype: (**Optional**) type of histogram. Must either be 'bar' (histograms next to each other), 'barstacked' (stacked histograms), 'step' (unfilled histograms) or 'stepfilled' (filled histograms).</span>
<span class="sd">    :param bool integralIsOne: (**Optional**) whether to normalise the integral of the histogram</span>
<span class="sd">    :param str label: (**Optional**) legend label</span>
<span class="sd">    :param str legendEdgeColor: (**Optional**) color of the legend edges. If None, there is no edge.</span>
<span class="sd">    :param int legendNcols: (**Optional**) number of columns in the legend</span>
<span class="sd">    :param int legendTextSize: (**Optional**) size for the legend</span>
<span class="sd">    :param str locLegend: (**Optional**) position of the legend</span>
<span class="sd">    :param str orientation: (**Optional**) orientation of the bars</span>
<span class="sd">    :param str outputName: (**Optional**) file name where save the figure. If None, the plot is not saved into a file.</span>
<span class="sd">    :param bool overwrite: (**Optional**) whether to overwrite the ouput file or not</span>
<span class="sd">    :param bool placeYaxisOnRight: (**Optional**) whether to place the y axis of the plot on the right or not</span>
<span class="sd">    :param int textsize: (**Optional**) size for the labels</span>
<span class="sd">    :param bool shadow: (**Optional**) whether to draw a shadow around the legend or not</span>
<span class="sd">    :param bool showLegend: (**Optional**) whether to show the legend or not</span>
<span class="sd">    :param int tickSize: (**Optional**) size of the ticks on both axes</span>
<span class="sd">    :param bool tightLayout: (**Optional**) whether to use bbox_inches='tight' if **tightLayout** is True or bbox_inches=None otherwise</span>
<span class="sd">    :param ndarray[float] weights:  (**Optional**) weights to apply to each value in **data**</span>
<span class="sd">    :param str xlabel: (**Optional**) x axis label</span>
<span class="sd">    :param list[float] xlim: (**Optional**) x-axis limits to use. If None, data bounds are used.</span>
<span class="sd">    :param str ylabel: (**Optional**) y axis label</span>
<span class="sd">    :param list[floats] ylim:  (**Optional**) y-axis limits to use. If None, data bounds are used</span>
<span class="sd">    :param int zorder: (**Optional**) plot position. The lower the value, the earlier it will be plotted</span>
<span class="sd">        </span>
<span class="sd">    :returns: Current axis, hist values, bin values, patches elements and legend elements</span>
<span class="sd">    """</span>
    
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">titlesize</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">'in'</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">tickSize</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">grid</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        
    <span class="c1">#hiding labels if required</span>
    <span class="k">if</span> <span class="n">hideXlabel</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">textsize</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">hideXticks</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">hideYticks</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">hideYlabel</span><span class="p">:</span>    
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">textsize</span><span class="p">)</span>
    
    <span class="c1">#Place Y axis on the right if required</span>
    <span class="k">if</span> <span class="n">placeYaxisOnRight</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_right</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">"right"</span><span class="p">)</span>
        
    <span class="c1">#Plotting</span>
    <span class="c1">#define X limits if required</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">rang</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rang</span> <span class="o">=</span> <span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#     print(data, bins, integralIsOne, weights, color, align)</span>
        
    <span class="n">n</span><span class="p">,</span> <span class="n">bns</span><span class="p">,</span> <span class="n">ptchs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="n">rang</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">integralIsOne</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                             <span class="n">align</span><span class="o">=</span><span class="n">align</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="n">histtype</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                             <span class="n">cumulative</span><span class="o">=</span><span class="n">cumulative</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="n">hatch</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">orientation</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="n">stacked</span><span class="p">)</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="c1">#set hatching pattern if there is one</span>
    
    <span class="k">if</span> <span class="n">showLegend</span><span class="p">:</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">locLegend</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">'size'</span><span class="p">:</span> <span class="n">legendTextSize</span><span class="p">},</span> <span class="n">shadow</span><span class="o">=</span><span class="n">shadow</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="n">fancybox</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">legendEdgeColor</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="n">frameon</span><span class="p">,</span>
                         <span class="n">framealpha</span><span class="o">=</span><span class="n">framealpha</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="n">legendNcols</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">if</span> <span class="n">outputName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1">#If we do not want to overwrite the file</span>
        <span class="n">f</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="c1">#Try to open it to check if it exists</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputName</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">if</span> <span class="n">f</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">'File </span><span class="si">%s</span><span class="s1"> already exists but overwritting was disabled. Thus exiting without writing.'</span> <span class="o">%</span><span class="n">outputName</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bns</span>
                
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outputName</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span>
        
        <span class="n">bbox_inches</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">tightLayout</span><span class="p">:</span>
            <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">'tight'</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outputName</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="n">bbox_inches</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">bns</span><span class="p">,</span> <span class="n">ptchs</span><span class="p">,</span> <span class="n">leg</span></div>

                
<span class="k">def</span> <span class="nf">asManyPlots</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">'''Alias for asManyPlots2. See asManyPlots2 docstring for more details.'''</span>
    
    <span class="k">return</span> <span class="n">asManyPlots2</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">asManyPlots2</span><span class="p">(</span><span class="n">numPlot</span><span class="p">,</span> <span class="n">datax</span><span class="p">,</span> <span class="n">datay</span><span class="p">,</span> 
                 <span class="n">dataProperties</span><span class="o">=</span><span class="p">{},</span> <span class="n">generalProperties</span><span class="o">=</span><span class="p">{},</span> <span class="n">axesProperties</span><span class="o">=</span><span class="p">{},</span> <span class="n">titleProperties</span><span class="o">=</span><span class="p">{},</span> 
                 <span class="n">colorbarProperties</span><span class="o">=</span><span class="p">{},</span> <span class="n">legendProperties</span><span class="o">=</span><span class="p">{},</span> <span class="n">outputProperties</span><span class="o">=</span><span class="p">{}):</span>
    
    <span class="sd">"""</span>
<span class="sd">    Function which plots on a highly configurable subplot grid either with pyplot.plot or pyplot.scatter. A list of X and Y arrays can be given to have multiple plots on the same subplot.</span>
<span class="sd">    This function has been developed to be used with numpy arrays or list of numpy arrays (structured or not). Working with astropy tables or any other kind of data structure might or might not work depending on its complexity and behaviour. </span>
<span class="sd">    </span>
<span class="sd">    Mandatory inputs</span>
<span class="sd">    ----------------</span>
<span class="sd">        numPlot : int (3 digits), list of 3 int or GridSpec array element</span>
<span class="sd">            subplot within which the data will be plotted. There are three possible methods to define a subplot:</span>
<span class="sd">                - the easiest way is to provide a three digits number such as 111 (1 line, 1 column, first subplot) or 212 (2 lines, 1 column, second subplot from left to right and top to bottom). The main issue with using three digits numbers is that it is limited to 9 subplots maximum</span>
<span class="sd">                - to overcome this issue, one can provide a list of three values (up to 99) instead such as [1, 1, 1] (similar to 111) or [15, 24, 30]</span>
<span class="sd">                - finally, if one wants to generate a grid with subplots having different x and y sizes (say a main subplot plot and a smaller residual subplot appended to the bottom of the main one), one can generate a highly tunable grid using matplotlib.gridspec.gridspec and then provide the desired subplot with the correct array element.</span>
<span class="sd">                  For instance, if one writes grid = gridspec(2, 1, height_ratios=[1, 0.2]) this should generate a grid with the second subplot below the first one, with the same width and a height 1/5th of the figure. Then one can provide grid[0] (grid[1]) for numPlot if one wants to plot on the first (second) subplot.</span>
<span class="sd">            </span>
<span class="sd">        datax: list of numpy arrays/lists</span>
<span class="sd">            list of x-axis data which should be plotted. Each data belongs to a single array. A LIST MUST BE PROVIDED, so even if just one data is plotted one should write [yourDataArray] and not directly yourDataArray.</span>
<span class="sd">            </span>
<span class="sd">            One may want to plot their data differently on the same plot (for instance one usual line plot and one scatter plot). This can be set in dataProperties dictionary using the key 'type' (see below for more information).</span>
<span class="sd">            asManyPlots2 provide three kinds of plots:</span>
<span class="sd">                - usual plot (line or points) with a potential global color set in the dictionary dataProperties with the key 'color'</span>
<span class="sd">                - scatter plot (only points, no line), where the color (set with 'color' key as well) and size of points (set with 'size' key in dataProperties dict) can vary from point to point to show any variation with a third dimension (refered as the z component in the following)</span>
<span class="sd">                - 'mix' type of plot where lines only are plotted and colour coded according to a third value (also set with 'color' key in plotProperties dict). For this kind of plot, each array within the list will correspond to a single line.</span>
<span class="sd">            </span>
<span class="sd">        datay : list of numpy arrays/lists</span>
<span class="sd">            list of y-axis data which should be plotted. See datax description for more details.</span>
<span class="sd">            </span>
<span class="sd">    Optional inputs</span>
<span class="sd">    ---------------</span>
<span class="sd">    </span>
<span class="sd">    Most optional inputs have been gathered within dictionary structures. This was done in order to reduce the number of optional parameters in the function declaration. Unless provided, default values will be used.</span>
<span class="sd">    </span>
<span class="sd">    For those who are not familiar with dictionnaries, here we provide an explanation on how to use them for this purpose. Say, one wants to put labels on the x and y axes. This can be done by providing values to 'xlabel' and 'ylabel' keys of axesProperties dictionary.</span>
<span class="sd">    Thus, one would write </span>
<span class="sd">    </span>
<span class="sd">        &gt;&gt;&gt; mydict = {'xlabel':'this is my x label', 'ylabel':'this is another text for the y label'}</span>
<span class="sd">        &gt;&gt;&gt; asManyPlots2(111, datax, datay, axesProperties=mydict)</span>
<span class="sd">        </span>
<span class="sd">    which will plot datay as a function of datax on a single subplot with x and y labels attached to the axes.</span>
<span class="sd">    </span>
<span class="sd">        dataProperties : dict</span>
<span class="sd">            dictionary gathering all tunable properties related to the data. See the list below for the complete list of dicionnary keys.</span>
<span class="sd">            </span>
<span class="sd">            Data points properties</span>
<span class="sd">            ----------------------</span>
<span class="sd">                'color' : list of str and/or arrays</span>
<span class="sd">                    list of colors for each plot. Each given color is mapped to the corresponding plot assuming 'color' and datax and datay are sorted in the same order. Default is 'black' for any kind of plot.</span>
<span class="sd">                        - for simple and 'mix' plots, color names must be provided</span>
<span class="sd">                        - for scatter plots, a list/array of values must be provided. This is because scatter plots actually map values to a color range and will apply a color to each point separately using this range. </span>
<span class="sd">                </span>
<span class="sd">                'fillstyle' : list of str</span>
<span class="sd">                    marker fillstyle to use on the plot. Default is 'full' for 'plot' and 'scatter' plots and 'none' for 'mix' plots. Possible values are 'full', 'left', 'right', 'bottom', 'top', 'none'.</span>
<span class="sd">                </span>
<span class="sd">                'marker' : list of str/matplotlib markers</span>
<span class="sd">                    list of markers used for the data. Default is 'o'.</span>
<span class="sd">                        - if one does not want to have a marker (for instance for line plots), one can provide None for the given plot</span>
<span class="sd">                        - by default, markers will not appear on 'mix' plots</span>
<span class="sd">                        </span>
<span class="sd">                'markerEdgeColor' : list of str</span>
<span class="sd">                    color of the marker edges. Default is None for each plot so that marker edges have the same color as the data color. If the marker is unfilled, this value will be overidden and the marker will recover the data color instead.</span>
<span class="sd">                    </span>
<span class="sd">                'markerSize' : list of int</span>
<span class="sd">                    list of marker sizes for each plot</span>
<span class="sd">                        - for 'plot' plots a single value, a single value must be provided</span>
<span class="sd">                        - for 'scatter' plots, either a single value or a list/array of values (one per data point) can be provided (the latter will scale data points size accordingly to their value)</span>
<span class="sd">                        - for 'mix' plots, a single value can be provided if you want to have markers on your colored line plots</span>
<span class="sd">                    </span>
<span class="sd">                'unfillMarker' : list of bool</span>
<span class="sd">                    whether to unfill the markers or not. This keyword is different from 'fillstyle'. 'unfillMarker' will remove the facecolor from the markers, whereas 'fillstyle' will modify the shape of the markers (by removing the top part for instance). Default is False for every plot.</span>
<span class="sd">                    </span>
<span class="sd">                'transparency' : float, list of floats between 0 and 1</span>
<span class="sd">                    transparency of the data points (1 is plain, 0 is invisible). Default is 1 for any kind of plot.</span>
<span class="sd">                </span>
<span class="sd">            Line properties</span>
<span class="sd">            ---------------</span>
<span class="sd">                'linewidth' : list of int</span>
<span class="sd">                    list of line widths in the plots. For 'scatter' plots, any value can be given as there will be no line. Default is given by 'linewidth' key in generalProperties dict.</span>
<span class="sd">                    </span>
<span class="sd">                'linestyle' : list of str</span>
<span class="sd">                    list of line styles. Default for 'plot' and 'mix' types of plots is given by 'linestyle' key in generalProperties dict.</span>
<span class="sd">            </span>
<span class="sd">            Plot properties</span>
<span class="sd">            ---------------</span>
<span class="sd">                'type' : list of 'plot', 'scatter' and/or 'mix'</span>
<span class="sd">                    list of plot type for each array in datax and datay. Default is 'plot' for every data. One value per array must be provided. Three values are possible:</span>
<span class="sd">                        - 'plot' to plot a simple plot (line or points) with a single color applied to all the data points</span>
<span class="sd">                        - 'scatter' to plot a scatter plot (only points, no line) where the points are colour coded according to some array of the same dimension as datax and datay provided in the 'color' key</span>
<span class="sd">                        - 'mix' to plot a line plot only where each line will have a different colour</span>
<span class="sd">        </span>
<span class="sd">                'order' : list of int</span>
<span class="sd">                     order in which the data will be plotted. Data with the lowest order will be plotted first. Default is order of appearance in the datax and datay lists.</span>
<span class="sd">    </span>
<span class="sd">        generalProperties : dict</span>
<span class="sd">            dictionary gathering all tunable general properties. See the list below for the complete list of dictionary keys.</span>
<span class="sd">            </span>
<span class="sd">            Ticks properties</span>
<span class="sd">            ----------------</span>
<span class="sd">                'hideTicksLabels' : bool</span>
<span class="sd">                    whether to hide ticks labels. Default is False.</span>
<span class="sd">                'ticksDirection' : 'in', 'out' or 'inout'</span>
<span class="sd">                    direction of the ticks on the plot. Default is 'inout'.</span>
<span class="sd">                'ticksLabelsSize' : int</span>
<span class="sd">                    size of the ticks labels on the plot and the colorbar. Default is 2 points below 'textsize' key value.</span>
<span class="sd">                'ticksSize' : int</span>
<span class="sd">                    size of the ticks on the plot and on the colorbar if there is one. Default is 7.</span>
<span class="sd">                    </span>
<span class="sd">            Text properties</span>
<span class="sd">            ---------------</span>
<span class="sd">                'rcParams' : dict</span>
<span class="sd">                    advanced properties to pass to matplotlib rcParams</span>
<span class="sd">                'textsize' : int</span>
<span class="sd">                    overall text size in points. Default is 24.</span>
<span class="sd">                    </span>
<span class="sd">            Scale properties</span>
<span class="sd">            ----------------</span>
<span class="sd">                'scale' : str</span>
<span class="sd">                    scale of both axes</span>
<span class="sd">                    </span>
<span class="sd">            Plot properties</span>
<span class="sd">            --------------------</span>
<span class="sd">                'linewidth' : int</span>
<span class="sd">                    overall line width used in plots. For 'scatter' plots, any value can be given as there will be no line. Default is 2.    </span>
<span class="sd">                'linestyle' : str</span>
<span class="sd">                    overall line style used in plots. Default for 'plot' and 'mix' types of plots is plain style ('-').</span>
<span class="sd">                'markersize' : int</span>
<span class="sd">                    overall size of the markers for 'plot' and 'scatter' plots. Default is 16.</span>
<span class="sd">                    </span>
<span class="sd">            Miscellanous properties</span>
<span class="sd">            -----------------------</span>
<span class="sd">                'hideGrid' : bool</span>
<span class="sd">                    whether to hide the grid or not. Default is False.</span>
<span class="sd">                'gridZorder' : int</span>
<span class="sd">                    z order of the grid. Default is 1000 (generally enough to be plotted in last).</span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">        axesProperties : dict</span>
<span class="sd">            dictionary gathering all tunable axes properties. See the list below for the complete list of dictionary keys.</span>
<span class="sd">            </span>
<span class="sd">            Ticks related keys</span>
<span class="sd">            ------------------</span>
<span class="sd">                'hideXticksLabels' : bool</span>
<span class="sd">                    whether to hide the x-axis ticks labels or not. Default is False.</span>
<span class="sd">                'hideYticksLabels' : bool</span>
<span class="sd">                    whether to hide the y-axis ticks labels or not. Default is False.</span>
<span class="sd">                'xTickDirection' : 'in', 'out' or 'inout'</span>
<span class="sd">                    where the x-axis ticks will appear. If 'in', they will be plotted within the subplots, if 'out', they will be plotted outside of the subplot and if 'inout', they will appear both within and outside. Default is 'tickDirection' value.</span>
<span class="sd">                'xTickSize' : int</span>
<span class="sd">                    size of the ticks on the x-axis. Default is 'tickSize' value. If a value is given, the 'tickSize' key value will be overriden. </span>
<span class="sd">                'yTickDirection' : 'in', 'out' or 'inout'</span>
<span class="sd">                    where the y-axis ticks will appear. If 'in', they will be plotted within the subplots, if 'out', they will be plotted outside of the subplot and if 'inout', they will appear both within and outside. Default is 'tickDirection' value.</span>
<span class="sd">                'yTickSize' : int</span>
<span class="sd">                    size of the ticks on the y-axis. Default is 'tickSize' value. If a value is given, the 'tickSize' key value will be overriden. </span>
<span class="sd">                </span>
<span class="sd">            Label related keys</span>
<span class="sd">            ------------------</span>
<span class="sd">                labelTextSize : int</span>
<span class="sd">                    size of the labels for every axis. Default is 24.</span>
<span class="sd">                'xlabel' :  str</span>
<span class="sd">                    label of the x-axis. Default is ''.</span>
<span class="sd">                xLabelTextSize : int</span>
<span class="sd">                    size of the x-axis label. Default is None. If a value is given, the 'labelTextSize' key value will be overriden. </span>
<span class="sd">                'ylabel' : str</span>
<span class="sd">                    label of the y-axis. Default is ''.</span>
<span class="sd">                yLabelTextSize : int</span>
<span class="sd">                    size of the y-axis label. Default is None. If a value is given, the 'labelTextSize' key value will be overriden. </span>
<span class="sd">                </span>
<span class="sd">            Scale and limits related keys</span>
<span class="sd">            -----------------------------</span>
<span class="sd">                'xscale' : str</span>
<span class="sd">                    scale for the y-axis (the most used are "linear", "log", "symlog"). Default is "linear".</span>
<span class="sd">                'yscale' : str</span>
<span class="sd">                    scale for the x-axis (the most used are "linear", "log", "symlog"). Default is "linear".</span>
<span class="sd">                    </span>
<span class="sd">                'xmax' : None, float or str</span>
<span class="sd">                    maximum value of the x-axis. Three different type of values can be given (default is None):</span>
<span class="sd">                        - None so that the maximum value of x data is used as upper limit</span>
<span class="sd">                        - float so that the given value is used as upper limit</span>
<span class="sd">                        - string with one of the following forms: 'num+offset' or '*+offset'</span>
<span class="sd">                    </span>
<span class="sd">                    in the latter case:</span>
<span class="sd">                        - num is an int corresponding to the position, in the x data list, of the data used to compute the minimum x value</span>
<span class="sd">                        - * corresponds to the full list of x data, so that the minimum value is that of the complete set of data</span>
<span class="sd">                        - offset is the offset applied to the x minimum value </span>
<span class="sd">                    For e.g., '0+-1' will compute the minimum value in the Oth data element in the x data list (assume it is equal to -3). The x-axis minmum value will therefore be equal to this value minus 1 (-3-1=-4)</span>
<span class="sd">                    For e.g., '*+2' will compute the minimum value of all the x data in the x data list and set the x-axis minmum value to this value plus 2.</span>
<span class="sd">                    </span>
<span class="sd">                'xmin' : None, float or str</span>
<span class="sd">                    minimum value of the x-axis. Three different type of values can be given (default is None), see 'xmax' description for more information.</span>
<span class="sd">                'ymax' : None, float or str</span>
<span class="sd">                    maximum value of the y-axis. Three different type of values can be given (default is None), see 'xmax' description for more information.</span>
<span class="sd">                'ymin' : None, float or str</span>
<span class="sd">                    minimum value of the y-axis. Three different type of values can be given (default is None), see 'xmax' description for more information.</span>
<span class="sd">                </span>
<span class="sd">            Position related keys</span>
<span class="sd">            ---------------------</span>
<span class="sd">                'xAxisPos' : 'bottom' or 'top'</span>
<span class="sd">                    where to place the main x-axis. Default is 'bottom'.</span>
<span class="sd">                'yAxisPos' : 'left' or 'right'</span>
<span class="sd">                    where to place the main y-axis. Default is 'left'.   </span>
<span class="sd">                    </span>
<span class="sd">        titleProperties : dict</span>
<span class="sd">            dictionary gathering all tunable main title properties. See the list below for the complete list of dictionary keys.</span>
<span class="sd">            </span>
<span class="sd">            Text related keys</span>
<span class="sd">            -----------------</span>
<span class="sd">                'color' : str</span>
<span class="sd">                    color of the title. Default is 'black'.</span>
<span class="sd">                'font' : str</span>
<span class="sd">                    title font. Default is 'sans-serif'.</span>
<span class="sd">                'label' : str</span>
<span class="sd">                    title label. Default is ''.</span>
<span class="sd">                'size' : int</span>
<span class="sd">                    title size in points. Default is 26.</span>
<span class="sd">                'style' : 'normal', 'italic' or 'oblique'</span>
<span class="sd">                    title text style. Default is 'normal'.</span>
<span class="sd">                'weight' : int within range [0, 1000] or 'ultralight', 'light', 'normal', 'regular', 'book', 'medium', 'roman', 'semibold', 'demibold', 'demi', 'bold', 'heavy', 'extra bold', 'black'</span>
<span class="sd">                    'boldness' of the title font. Default is 'regular'.</span>
<span class="sd">                    </span>
<span class="sd">            Position related keys</span>
<span class="sd">            ---------------------</span>
<span class="sd">                'position' : 'center', 'left' or 'right'</span>
<span class="sd">                    where the title will be placed. Default is 'center'</span>
<span class="sd">                'verticalOffset' : float</span>
<span class="sd">                    title vertical offset from the regular position. Default is None, so that no offset is applied.</span>
<span class="sd">                    </span>
<span class="sd">        colorbarProperties : dict</span>
<span class="sd">            dictionary gathering all tunable colorbar properties. See the list below for the complete list of dictionary keys.</span>
<span class="sd">            A colorbar will only be plotted if at least one scatter plot is provided.</span>
<span class="sd">            </span>
<span class="sd">            General colobar properties</span>
<span class="sd">            --------------------------</span>
<span class="sd">                'hide' : bool</span>
<span class="sd">                    whether to hide the colorbar or not. Default is False.</span>
<span class="sd">                'orientation' : 'vertical' or 'horizontal'</span>
<span class="sd">                    orientation of the colorbar. Default is 'vertical'.</span>
<span class="sd">            </span>
<span class="sd">            Color map related keys</span>
<span class="sd">            ----------------------</span>
<span class="sd">                'cmap' : str or matplotlib colormap</span>
<span class="sd">                    colormap used by the scatter plot and in the colorbar. Default is 'Greys'.</span>
<span class="sd">                'min' : float</span>
<span class="sd">                    minmum value for the colormap. Default is None, so that the minimum value in the z component arrays of the scatter data will be used.</span>
<span class="sd">                'max' : float</span>
<span class="sd">                    maximum value for the colormap. Default is None, so that the maximum value in the z component arrays of the scatter data will be used.</span>
<span class="sd">                'offsetCenter' : float</span>
<span class="sd">                    colormap center of the dynamic color range. The given value will split the colormap mapping in two at the given position. This can be used to give more or less dynamic range for a certain range of values. Default is None, so that the regular center is used.</span>
<span class="sd">                'powerlaw' : float</span>
<span class="sd">                    powerlaw coefficient used in the 'powerlaw' scale. Default is 2.0.</span>
<span class="sd">                'scale' : matplotlib.colors.Normalize instance or str</span>
<span class="sd">                    norm of the colormap. Default is 'linear'. There are different ways one can change the scale of the colormap using an str argument</span>
<span class="sd">                        - for 'linear' and 'log' scales, just provide 'linear' or 'log' and the minimum and maximum values will be mapped from 'min' and 'max' keys</span>
<span class="sd">                        - for a 'symlog' scale, one can provide additional values using 'symLogLinThresh' and 'symLogLinScale' keys to change the range of the linear scale part.</span>
<span class="sd">                        - for a 'powerlaw' scale (z = y^n), one can provide an additional value using 'powerlaw' key to change the powerlaw coefficient.</span>
<span class="sd">                        </span>
<span class="sd">                    Note that it is also possible for a linear scale, to provide the 'offsetCenter' key in order to move the colormap center further up or down the colorbar values. This can be used to create two different mapping on either side of the center and modify the dynamic color range of each.</span>
<span class="sd">                    For instance, if one maps values between -10 and 10, but would like to have more details in the range [-5, 10], one can write colorbarProperties={'offsetCenter':-5} to split the colormap in two at position -5.</span>
<span class="sd">                    </span>
<span class="sd">                    It is also possible to declare a colormap normalize instance before calling matplotlib and directly give the colormap as a value for 'scale'.</span>
<span class="sd">                </span>
<span class="sd">                'symLogLinThresh' : float</span>
<span class="sd">                    linear threshold positive value. For a symetric log scale ('symlog'), this will correspond to the value such that the range [-linthresh, +linthresh] will be linearly maped around zero to avoid the colormap instance to diverge when reaching low values. Default is 0.1.</span>
<span class="sd">                'symLogLinScale' : float</span>
<span class="sd">                    linear scale factor in the colormap. This is used to strech or compress the range of the linear scale part in the colormap. Default is 1.0 and will correspond to 1 decade in the negative and in the positive part of the colormap. Default is 1.0.</span>
<span class="sd">                    </span>
<span class="sd">            Label related keys</span>
<span class="sd">            ------------------</span>
<span class="sd">                'label' : str</span>
<span class="sd">                    colorbar label placed next to it. Default is ''.</span>
<span class="sd">                'labelSize' : int</span>
<span class="sd">                    size in points of the colorbar label. Default is 24.</span>
<span class="sd">                </span>
<span class="sd">            Ticks related keys</span>
<span class="sd">            ------------------</span>
<span class="sd">                'ticks' : list</span>
<span class="sd">                    list of ticks plotted on the colorbar. If 'ticksLabels' key values are given, these values will be overriden and replaced by those given by 'ticksLabels'. Default if None, so that matplotlib automatically adjust the ticks values.</span>
<span class="sd">                'ticksColor' : str</span>
<span class="sd">                    color of the ticks on the colorbar. Default is 'black'.</span>
<span class="sd">                'ticksSize' : int</span>
<span class="sd">                    size of the ticks in points. Default is given by 'ticksSize' key in generalProperties dict.</span>
<span class="sd">                    </span>
<span class="sd">            Ticks labels properties</span>
<span class="sd">            -----------------------</span>
<span class="sd">                'ticksLabels' : list</span>
<span class="sd">                    list of ticks labels (str, int, float, etc.) for the colorbar. Default value is None, so that the ticks values are plotted on the colorbar.</span>
<span class="sd">                    This key can be used to change the colorbar ticks printed on the figure, without changing the scatter plot z values.</span>
<span class="sd">                    </span>
<span class="sd">                'ticksLabelsColor' : str</span>
<span class="sd">                    color of the ticks labels on the colorbar. Default is 'black'</span>
<span class="sd">                'ticksLabelsRotation' : float</span>
<span class="sd">                    counter-clockwise rotation of the ticks labels in degrees. Default is 0°.</span>
<span class="sd">                'ticksLabelsSize' : int</span>
<span class="sd">                    size of the labels associated to the ticks. Default is given by 'ticksLabelsSize' in generalProperties dict.</span>
<span class="sd">                    </span>
<span class="sd">        legendProperties : dict</span>
<span class="sd">            dictionary gathering all tunable legend properties. See the list below for the complete list of dictionary keys. By default, the legend is hidden.</span>
<span class="sd">            </span>
<span class="sd">            General legend properties keys</span>
<span class="sd">            ------------------------------</span>
<span class="sd">                'loc' : str/int</span>
<span class="sd">                    legend location on the plot. Default is 'best'.</span>
<span class="sd">                'ncols' : int</span>
<span class="sd">                    number of columns in the legend. Default is 1 so that every label will appear on a new line. </span>
<span class="sd">                    For instance legendProperties={'numberColumns':3} will split labels into three columns.</span>
<span class="sd">                'order' : int</span>
<span class="sd">                    order of appearance of the legend (zorder). Default is 1000.</span>
<span class="sd">                    </span>
<span class="sd">            Text related keys</span>
<span class="sd">            -----------------</span>
<span class="sd">                'labels' : list of str</span>
<span class="sd">                    list of labels for the data. Labels must be given in the same order as the plots. Default is None so that no labels are shown for any kind of plot.</span>
<span class="sd">                'labelSize' : int</span>
<span class="sd">                    size of the text in the legend. Default is given by 'textsize' key in generalProperties dict.</span>
<span class="sd">            </span>
<span class="sd">            Lines and markers related keys</span>
<span class="sd">            ------------------------------</span>
<span class="sd">                'lineColor' : list of str</span>
<span class="sd">                    list of colors of the lines appearing in the legend before the text. Default is None so that the line color in the plot is used for plots and 'black' is used for scatter plots.</span>
<span class="sd">                    If provided, this list must contain as many colors as there are data plotted. For instance, if one plots a plot and a scatter plot, one may write legendProperties{'lineColor':['red', 'blue']} to draw the plot line in red and the scatter plot marker in blue within the legend.</span>

<span class="sd">                'markerEdgeColor' : list of str</span>
<span class="sd">                    list of marker edge colors shown in the legend. Default is None so that the line color in the plot is used for plots marker edges and black is used for scatter plots marker edges.</span>
<span class="sd">                    If provided, this list must contain as many colors as there are data plotted. For instance, if one plots a plot and a scatter plot, one may write legendProperties={'markerEdgeColor':['red', 'blue']} to draw the plot marker edge color in red and the scatter plot marker edge color in blue within the legend.</span>
<span class="sd">            </span>
<span class="sd">                'markerFaceColor' : list of str</span>
<span class="sd">                    list of marker face colors (main area) shown in the legend. Default is None so that the line color in the plot is used for plots markers and black is used for scatter plots markers.</span>
<span class="sd">                    If provided, this list must contain as many colors as there are data plotted. For instance, if one plots a plot and a scatter plot, one may write legendProperties={'markerFaceColor':['red', 'blue']} to draw the plot marker face color in red and the scatter plot marker face color in blue within the legend.</span>
<span class="sd">    </span>
<span class="sd">                'markerPosition' : 'left' or 'right'</span>
<span class="sd">                    whether to place the marker in the legend before the text ('left') or after it ('right'). Default is 'left'.</span>
<span class="sd">                    </span>
<span class="sd">                'markerScale' : int/float</span>
<span class="sd">                    scale factor to apply to the markers in the legend to increase or decrease their size relative to the plot (size_in_legend = markerScale*size_in_plot). Default is 1.0 so that they have the same size as in the plot.</span>
<span class="sd">    </span>
<span class="sd">            Style related keys</span>
<span class="sd">            ------------------</span>
<span class="sd">                'transparency' : float</span>
<span class="sd">                    transparency of the legend background. 1 is plain, 0 is fully transparent. Default is 1.</span>
<span class="sd">                'background' : str</span>
<span class="sd">                    color of the legend background. Default is None so that the default value in your rcParams file will be used (usually white).</span>
<span class="sd">                'fancy' : bool</span>
<span class="sd">                    whether to have a fancy legend box (round edges) or not. Default is True.</span>
<span class="sd">                'shadow' : bool</span>
<span class="sd">                    whether to draw a shadow around the legend or not. Default is True.</span>
<span class="sd">                'title' : str</span>
<span class="sd">                    legend title. Default is empty string.</span>
<span class="sd">                'titleSize' : float</span>
<span class="sd">                    legend title font size. Default is given by 'textsize' key in generalProperties dict.</span>
<span class="sd">    </span>
<span class="sd">        outputProperties : dict</span>
<span class="sd">            dictionary gathering all tunable ouput properties. See the list below for the comple list of dictionary keys.</span>
<span class="sd">            </span>
<span class="sd">            Properties</span>
<span class="sd">            ----------</span>
<span class="sd">                'outputName' : str</span>
<span class="sd">                    name of the file to save the graph into. If None, the plot will not be saved into a file. Default is None.</span>
<span class="sd">                'overwrite' : bool</span>
<span class="sd">                    whether to overwrite the ouput file or not. Default is False.</span>
<span class="sd">                'tightLayout' : bool</span>
<span class="sd">                    whether to set a tight_layout in the ouput image (no blank space on the sides) or not. Default is True.</span>
<span class="sd">                'transparent' : bool</span>
<span class="sd">                    whether to have a transparent background or not. Default is False.</span>
<span class="sd">        </span>
<span class="sd">    Return in this order: the current subplot, a list of all the different plots, the legend (None if no legend) and the colorbar (None if no colorbar).</span>
<span class="sd">    """</span>
    
    <span class="c1">############################################################################################</span>
    <span class="c1">#                    Fonctions used to speed things up in the code                         #</span>
    <span class="c1">############################################################################################</span>
    
    <span class="k">def</span> <span class="nf">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">typeToCheck</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Check data type and if not correct transform it into a list of a certain length</span>
<span class="sd">        </span>
<span class="sd">        Mandatory inputs</span>
<span class="sd">        ----------------</span>
<span class="sd">            data : any type</span>
<span class="sd">                data we want to check the type</span>
<span class="sd">            typeToCheck : any type</span>
<span class="sd">                type data should have</span>
<span class="sd">        </span>
<span class="sd">        Optional inputs</span>
<span class="sd">        ---------------</span>
<span class="sd">            length : int</span>
<span class="sd">                length of the output list</span>
<span class="sd">                </span>
<span class="sd">        Return given data if type is correct or a list of a given length with data value inside if not.</span>
<span class="sd">        """</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">typeToCheck</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span><span class="o">*</span><span class="n">length</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span><span class="o">*</span><span class="n">length</span>
        <span class="k">return</span> <span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">completeList</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Complete a list with a default value if it is too short.</span>
<span class="sd">        </span>
<span class="sd">        Mandatory inputs</span>
<span class="sd">        ----------------</span>
<span class="sd">            data : list</span>
<span class="sd">                data to append default values to</span>
<span class="sd">            default : any type</span>
<span class="sd">                default value to append at the end of the data to complete the list</span>
<span class="sd">            length : int</span>
<span class="sd">                length the data list should have </span>
<span class="sd">        </span>
<span class="sd">        Append default values to the list and return the new list.</span>
<span class="sd">        """</span>
        
        <span class="n">ll</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ll</span> <span class="o">!=</span> <span class="n">length</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;=</span> <span class="n">ll</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span>
    
    <span class="k">def</span> <span class="nf">isType</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">typeToCheck</span><span class="p">,</span> <span class="n">varName</span><span class="o">=</span><span class="s1">'NOT PROVIDED'</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Check data type.</span>
<span class="sd">        </span>
<span class="sd">        Mandatory inputs</span>
<span class="sd">        ----------------</span>
<span class="sd">            data : any type</span>
<span class="sd">                data we want to check the type</span>
<span class="sd">            typeToCheck : any type</span>
<span class="sd">                type data should have</span>
<span class="sd">                </span>
<span class="sd">        Optional inputs</span>
<span class="sd">        ---------------</span>
<span class="sd">            varName : str</span>
<span class="sd">                the name of the variable we want to test. It is used if an error is raised.</span>
<span class="sd">        </span>
<span class="sd">        Raise a TypeError if the data type is not correct or return True if it is.</span>
<span class="sd">        """</span>
        
        <span class="n">typ</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">typeToCheck</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"TypeError: the given variable '</span><span class="si">%s</span><span class="s2">' has type </span><span class="si">%s</span><span class="s2"> but the program requires it to have type </span><span class="si">%s</span><span class="s2">. In order for the program to work, please provide the correct type. Cheers !"</span> <span class="o">%</span><span class="p">(</span><span class="n">varName</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">typeToCheck</span><span class="p">,</span> <span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">def</span> <span class="nf">setDefault</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Set a default value in data list when given elements are None</span>
<span class="sd">        </span>
<span class="sd">        Mandatory inputs</span>
<span class="sd">        ----------------</span>
<span class="sd">            data : list</span>
<span class="sd">                data with any values whose None values will be replaced by a default value instead</span>
<span class="sd">                </span>
<span class="sd">        Optional inputs</span>
<span class="sd">        ---------------</span>
<span class="sd">            default : any type/list of any type</span>
<span class="sd">                default value which will replace None values</span>
<span class="sd">                </span>
<span class="sd">        Return a new list with None values replaced by a default one.</span>
<span class="sd">        """</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">default</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="p">[</span><span class="n">default</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">i</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="n">num</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data</span>
    
    <span class="k">def</span> <span class="nf">setListFromDict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Fill a list with values from a dictionary or from default ones if the key is not in the dictionary.</span>
<span class="sd">        </span>
<span class="sd">        Mandatory inputs</span>
<span class="sd">        ----------------</span>
<span class="sd">            dictionary : dict</span>
<span class="sd">                dictionary to get the keys values from</span>
<span class="sd">        </span>
<span class="sd">        Optional inputs</span>
<span class="sd">        ---------------</span>
<span class="sd">            default : list</span>
<span class="sd">                list of default values if given key is not in dictionary</span>
<span class="sd">            keys : list of str</span>
<span class="sd">                list of key names whose values will be appended into the list</span>
<span class="sd">                </span>
<span class="sd">        Return a list with values retrived from a dictionary keys or from a list of default values.</span>
<span class="sd">        """</span>
        
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dictionary</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>
    
    <span class="k">def</span> <span class="nf">checkBoundStr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">datanum</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'+'</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">datanum</span> <span class="o">!=</span> <span class="s1">'*'</span><span class="p">:</span>
                <span class="n">datanum</span>    <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">datanum</span><span class="p">)</span>
            <span class="n">value</span>          <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Incorrect format (</span><span class="si">%s</span><span class="s1">) for </span><span class="si">%s</span><span class="s1">. If a string is provided it must have a format similar to 1+-2 or *+4.'</span> <span class="o">%</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datanum</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">datanum</span> <span class="o">!=</span> <span class="s1">'*'</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Mapping </span><span class="si">%s</span><span class="s1"> format into int and float failed. Check again that you provided the correct format. Cheers !'</span> <span class="o">%</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">datanum</span> <span class="o">!=</span> <span class="s1">'*'</span> <span class="ow">and</span> <span class="n">datanum</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Given plot number for </span><span class="si">%s</span><span class="s1"> is negative. Only non-negative numbers are accepted.'</span> <span class="o">%</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">datanum</span> <span class="o">!=</span> <span class="s1">'*'</span> <span class="ow">and</span> <span class="n">datanum</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">'Given plot number (</span><span class="si">%d</span><span class="s1">) for </span><span class="si">%s</span><span class="s1"> is too large. Expected a number below </span><span class="si">%d</span><span class="s1">'</span> <span class="o">%</span><span class="p">(</span><span class="n">datanum</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">plots</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            
        
        <span class="k">return</span> <span class="n">datanum</span><span class="p">,</span> <span class="n">value</span>
        
    <span class="k">class</span> <span class="nc">gatherThingsUp</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        An empty class used to store data within the same object.</span>
<span class="sd">        """</span>
        
        <span class="n">info</span> <span class="o">=</span> <span class="s2">"A simple container to gather things up."</span>
    
    
    <span class="c1">##################################################</span>
    <span class="c1">#                  General layout                #</span>
    <span class="c1">##################################################</span>
    
    <span class="n">layout</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">generalProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'generalProperties'</span><span class="p">):</span>
        
        <span class="n">layout</span><span class="o">.</span><span class="n">textsize</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">rcParams</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">generalProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'textsize'</span><span class="p">,</span> <span class="s1">'rcParams'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
        
        <span class="c1"># general ticks properties</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">labelSize</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">generalProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'ticksLabelsSize'</span><span class="p">,</span> <span class="s1">'ticksSize'</span><span class="p">,</span> <span class="s1">'tickDirection'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="n">layout</span><span class="o">.</span><span class="n">textsize</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">'in'</span><span class="p">])</span>
        
        <span class="c1"># General properties</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">markersize</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">hideLabels</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">generalProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'markersize'</span><span class="p">,</span> <span class="s1">'hideTicksLabels'</span><span class="p">,</span> <span class="s1">'scale'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">'linear'</span><span class="p">])</span>

        <span class="c1"># General grid properties</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">hide</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zorder</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">generalProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'hideGrid'</span><span class="p">,</span> <span class="s1">'gridZorder'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>

        <span class="c1"># General line properties</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">generalProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'linewidth'</span><span class="p">,</span> <span class="s1">'linestyle'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="n">layout</span><span class="o">.</span><span class="n">rcParams</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">layout</span><span class="o">.</span><span class="n">rcParams</span><span class="p">)</span>
        
        
    <span class="c1">################################################################################################</span>
    <span class="c1">#                  Checking datax and datay are lists with a similar shape                     #</span>
    <span class="c1">################################################################################################</span>
    
    <span class="n">isType</span><span class="p">(</span><span class="n">datax</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="s2">"datax"</span><span class="p">)</span>
    <span class="n">isType</span><span class="p">(</span><span class="n">datay</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="s2">"datay"</span><span class="p">)</span>
    
    <span class="c1"># Checking shape consistency between datax and datay</span>
    <span class="n">shpX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">datax</span><span class="p">)</span>
    <span class="n">shpY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">datay</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shpX</span> <span class="o">!=</span> <span class="n">shpY</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Shape inconsistency: datax has shape </span><span class="si">%s</span><span class="s2"> but datay has shape </span><span class="si">%s</span><span class="s2">. Please provide data with similar shape. Cheers !"</span> <span class="o">%</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">shpX</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">shpY</span><span class="p">)))</span>
    
    
    <span class="c1">################################################################################################</span>
    <span class="c1">#           Checking input type and setting values from optional dictionnaries                 #</span>
    <span class="c1">#              Gathering data properties into a single object for simplicity                   #</span>
    <span class="c1">################################################################################################   </span>
    
    <span class="c1"># If everything went fine, we can define a few general properties useful later on</span>
    <span class="n">data</span>                   <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span>         <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span>            <span class="o">=</span> <span class="n">datax</span>
    <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span>            <span class="o">=</span> <span class="n">datay</span>
    <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">min</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
    <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">max</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
    <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">min</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
    <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">max</span>             <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">])</span>
    <span class="n">data</span><span class="o">.</span><span class="n">nplots</span>            <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">dataProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'dataProperties'</span><span class="p">):</span>
        
        <span class="c1"># Set data properties for the plots</span>
        <span class="n">data</span><span class="o">.</span><span class="n">zorder</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">transparency</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">dataProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'order'</span><span class="p">,</span> <span class="s1">'color'</span><span class="p">,</span> <span class="s1">'type'</span><span class="p">,</span> <span class="s1">'transparency'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="s1">'plot'</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">])</span>
        
        <span class="c1"># Set properties of the markers on the plots</span>
        <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">unfill</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgeColor</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">dataProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'marker'</span><span class="p">,</span> <span class="s1">'markerSize'</span><span class="p">,</span> <span class="s1">'markerFillstyle'</span><span class="p">,</span> <span class="s1">'unfillMarker'</span><span class="p">,</span> <span class="s1">'markerEdgeColor'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[[</span><span class="s1">'o'</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">])</span>
        
        <span class="c1"># Set properties of the lines on the plots</span>
        <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">dataProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'linewidth'</span><span class="p">,</span> <span class="s1">'linestyle'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
        
        <span class="c1"># If the user provides a single value, we change it to a list</span>
        <span class="n">data</span><span class="o">.</span><span class="n">type</span>          <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>          <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">transparency</span>  <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">transparency</span><span class="p">,</span>  <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">type</span>   <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>   <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">unfill</span> <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">unfill</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span>    <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>    <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)]</span>
        
        <span class="c1"># If the user provides an incomplete list, we complete it</span>
        <span class="n">completeList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">transparency</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">completeList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">)</span>
        <span class="n">completeList</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">unfill</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>      
            <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span>      <span class="o">=</span> <span class="p">[]</span>
            
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span> <span class="o">=</span> <span class="p">[]</span>
            
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span>       <span class="o">=</span> <span class="p">[]</span>
            
        <span class="c1"># If data.color is not provided, we set plot colors to 'black' and scatter plots points to the same value</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'black'</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">setDefault</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">'black'</span><span class="p">)</span>
        
        <span class="c1"># Complete the size list with either 0 of the default value is the list is not complete</span>
        <span class="n">lms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  
        <span class="n">lmf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span><span class="p">)</span>
        <span class="n">llw</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">lls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>
        <span class="n">lc</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">typ</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'mix'</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lms</span><span class="p">:</span>                
                    <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lmf</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'none'</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lc</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'black'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lms</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layout</span><span class="o">.</span><span class="n">markersize</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lmf</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'full'</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lc</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'black'</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'scatter'</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">llw</span><span class="p">:</span>    
                    <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lls</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"None"</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lc</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'black'</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">llw</span><span class="p">:</span>    
                    <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layout</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">lls</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layout</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>
            
        <span class="c1"># Set marker edge colors to face corlor (with 'face') if data points are supposed to be unfilled only for scatter plots</span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">nfllMrkr</span><span class="p">,</span> <span class="n">typ</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">unfill</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'scatter'</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nfllMrkr</span> <span class="ow">or</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgeColor</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgeColor</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'face'</span>

    <span class="c1">########################################</span>
    <span class="c1">#            Axes properties           #</span>
    <span class="c1">########################################</span>
    
    <span class="n">xaxis</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="n">yaxis</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">ticks</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">axesProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'axesProperties'</span><span class="p">):</span>
        
        <span class="c1"># Label properties</span>
        <span class="c1"># X axis</span>
        <span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">axesProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"xlabel"</span><span class="p">,</span> <span class="s2">"xLabelTextSize"</span><span class="p">,</span> <span class="s2">"xscale"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">labelSize</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">scale</span><span class="p">])</span>
        <span class="c1"># y-axis</span>
        <span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">axesProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"ylabel"</span><span class="p">,</span> <span class="s2">"yLabelTextSize"</span><span class="p">,</span> <span class="s2">"yscale"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">labelSize</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">scale</span><span class="p">])</span>

        <span class="c1"># Ticks properties</span>
        <span class="c1"># x-axis</span>
        <span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">hideLabels</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">axesProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"hideXticksLabels"</span><span class="p">,</span> <span class="s2">"xTickSize"</span><span class="p">,</span> <span class="s2">"xTickDirection"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span><span class="p">])</span>

        <span class="c1"># y-axis</span>
        <span class="n">yaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">hideLabels</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">axesProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"hideYticksLabels"</span><span class="p">,</span> <span class="s2">"yTickSize"</span><span class="p">,</span> <span class="s2">"yTickDirection"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span><span class="p">])</span>
        
        <span class="c1"># Other properties</span>
        <span class="n">xaxis</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">axesProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"xAxisPos"</span><span class="p">,</span> <span class="s2">"yAxisPos"</span><span class="p">,</span> <span class="s2">"xmin"</span><span class="p">,</span> <span class="s2">"xmax"</span><span class="p">,</span> <span class="s2">"ymin"</span><span class="p">,</span> <span class="s2">"ymax"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">"bottom"</span><span class="p">,</span> <span class="s2">"left"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
      
    <span class="c1"># Check minimum and maximum axes values first</span>
    <span class="n">xminPlot</span>                 <span class="o">=</span> <span class="s1">'*'</span> 
    <span class="n">xminOffset</span>               <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">xminPlot</span><span class="p">,</span> <span class="n">xminOffset</span> <span class="o">=</span> <span class="n">checkBoundStr</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s1">'xaxis.min'</span><span class="p">)</span>
        <span class="n">xaxis</span><span class="o">.</span><span class="n">min</span>            <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">xmaxPlot</span>                 <span class="o">=</span> <span class="s1">'*'</span> 
    <span class="n">xmaxOffset</span>               <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">xmaxPlot</span><span class="p">,</span> <span class="n">xmaxOffset</span> <span class="o">=</span> <span class="n">checkBoundStr</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s1">'xaxis.max'</span><span class="p">)</span>
        <span class="n">xaxis</span><span class="o">.</span><span class="n">max</span>            <span class="o">=</span> <span class="kc">None</span>
        
    <span class="n">yminPlot</span>                 <span class="o">=</span> <span class="s1">'*'</span> 
    <span class="n">yminOffset</span>               <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yaxis</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">yminPlot</span><span class="p">,</span> <span class="n">yminOffset</span> <span class="o">=</span> <span class="n">checkBoundStr</span><span class="p">(</span><span class="n">yaxis</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s1">'yaxis.min'</span><span class="p">)</span>
        <span class="n">yaxis</span><span class="o">.</span><span class="n">min</span>            <span class="o">=</span> <span class="kc">None</span>
    
    <span class="n">ymaxPlot</span>                 <span class="o">=</span> <span class="s1">'*'</span> 
    <span class="n">ymaxOffset</span>               <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yaxis</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ymaxPlot</span><span class="p">,</span> <span class="n">ymaxOffset</span> <span class="o">=</span> <span class="n">checkBoundStr</span><span class="p">(</span><span class="n">yaxis</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s1">'yaxis.max'</span><span class="p">)</span>
        <span class="n">yaxis</span><span class="o">.</span><span class="n">max</span>            <span class="o">=</span> <span class="kc">None</span>
        
        
    <span class="c1"># Set x and y bounds if not provided</span>
    <span class="k">if</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xminPlot</span> <span class="o">==</span> <span class="s1">'*'</span><span class="p">:</span>
            <span class="n">xaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">])</span> <span class="o">+</span> <span class="n">xminOffset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">xminPlot</span><span class="p">])</span> <span class="o">+</span> <span class="n">xminOffset</span>
            
    <span class="k">if</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">xmaxPlot</span> <span class="o">==</span> <span class="s1">'*'</span><span class="p">:</span>
            <span class="n">xaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">])</span> <span class="o">+</span> <span class="n">xmaxOffset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">xmaxPlot</span><span class="p">])</span> <span class="o">+</span> <span class="n">xmaxOffset</span>
            
    <span class="k">if</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">yminPlot</span> <span class="o">==</span> <span class="s1">'*'</span><span class="p">:</span>
            <span class="n">yaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">])</span> <span class="o">+</span> <span class="n">yminOffset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">yminPlot</span><span class="p">])</span> <span class="o">+</span> <span class="n">yminOffset</span>
            
    <span class="k">if</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ymaxPlot</span> <span class="o">==</span> <span class="s1">'*'</span><span class="p">:</span>
            <span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">])</span> <span class="o">+</span> <span class="n">ymaxOffset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">ymaxPlot</span><span class="p">])</span> <span class="o">+</span> <span class="n">ymaxOffset</span>
        
    <span class="c1">#########################################</span>
    <span class="c1">#             Title properties          #</span>
    <span class="c1">#########################################</span>
    
    <span class="n">title</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">titleProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'titleProperties'</span><span class="p">):</span>
        <span class="n">title</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">font</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">title</span><span class="o">.</span><span class="n">verticalOffset</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">titleProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"color"</span><span class="p">,</span> <span class="s2">"font"</span><span class="p">,</span> <span class="s2">"label"</span><span class="p">,</span> <span class="s2">"size"</span><span class="p">,</span> <span class="s2">"style"</span><span class="p">,</span> <span class="s2">"weight"</span><span class="p">,</span> <span class="s2">"position"</span><span class="p">,</span> <span class="s2">"verticalOffset"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">'black'</span><span class="p">,</span> <span class="s1">'sans-serif'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="s1">'normal'</span><span class="p">,</span> <span class="s1">'regular'</span><span class="p">,</span> <span class="s1">'center'</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
    
    
    <span class="c1">########################################</span>
    <span class="c1">#          Colormap properties         #</span>
    <span class="c1">########################################</span>
    
    <span class="n">colorbar</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">colorbarProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'colorbarProperties'</span><span class="p">):</span>
        
        <span class="c1"># General properties</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">hide</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">colorbarProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"hide"</span><span class="p">,</span> <span class="s2">"orientation"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="s1">'vertical'</span><span class="p">])</span>
        
        <span class="c1"># Cmap properties</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">colorbarProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"cmap"</span><span class="p">,</span> <span class="s2">"min"</span><span class="p">,</span> <span class="s2">"max"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">'Greys'</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
        
        <span class="c1"># Ticks properties</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">colorbarProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"ticks"</span><span class="p">,</span> <span class="s2">"ticksSize"</span><span class="p">,</span> <span class="s2">"ticksColor"</span><span class="p">,</span> <span class="s2">"ticksLabels"</span><span class="p">,</span> <span class="s2">"ticksLabelsSize"</span><span class="p">,</span> <span class="s2">"ticksLabelsColor"</span><span class="p">,</span> <span class="s2">"ticksLabelsRotation"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span>  <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s1">'black'</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">labelSize</span><span class="p">,</span> <span class="s1">'black'</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        
        <span class="c1"># Scale properties</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">offsetCenter</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">powerlaw</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">symLogLinThresh</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">symLogLinScale</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">colorbarProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"offsetCenter"</span><span class="p">,</span> <span class="s2">"powerlaw"</span><span class="p">,</span> <span class="s2">"scale"</span><span class="p">,</span> <span class="s2">"symLogLinThresh"</span><span class="p">,</span> <span class="s2">"symLogLinScale"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'linear'</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        
        <span class="c1"># Label properties</span>
        <span class="n">colorbar</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">colorbarProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">"label"</span><span class="p">,</span> <span class="s2">"labelSize"</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">textsize</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Keys 'ticksLabels' and 'ticks' in colorbarProperties dict have different lengths. Please provide both keys with the same number of elements. Cheers !"</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"Keys 'ticksLabels' and 'ticks' should be lists or None. Please provide a list of values for 'ticks' at the very least if you want to change the colorbar ticks. Cheers !"</span><span class="p">)</span>
        
        
        <span class="c1">###################################################</span>
        <span class="c1">#        Compute cmap minimum and maximum         #</span>
        <span class="c1">###################################################</span>
        
        <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">typ</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'scatter'</span><span class="p">:</span>
                    <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span> <span class="o">&gt;</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Given minimum cmap value with key 'min' in colorbarProperties dict is larger than given maximum cmap value with key 'max'. Please provide value such that min &lt;= max. Cheers !"</span><span class="p">)</span>
        
        <span class="c1">#####################################################</span>
        <span class="c1">#           Defining colorbar normalisation         #</span>
        <span class="c1">#####################################################</span>
        
        <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">offsetCenter</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">scale</span> <span class="o">==</span> <span class="s2">"linear"</span><span class="p">:</span>
            <span class="n">colorbar</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="s1">'div'</span>
        
        <span class="c1"># Creating the normalize instance for the colorbar</span>
        <span class="n">colorbarDict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'linear'</span><span class="p">:</span>   <span class="p">{</span><span class="s1">'function'</span><span class="p">:</span><span class="n">Normalize</span><span class="p">,</span>     <span class="s1">'params'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'vmin'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s1">'vmax'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span><span class="p">}},</span>
                        <span class="s1">'div'</span><span class="p">:</span>      <span class="p">{</span><span class="s1">'function'</span><span class="p">:</span><span class="n">TwoSlopeNorm</span><span class="p">,</span>  <span class="s1">'params'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'vmin'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s1">'vmax'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s1">'vcenter'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">offsetCenter</span><span class="p">}},</span>
                        <span class="s1">'log'</span><span class="p">:</span>      <span class="p">{</span><span class="s1">'function'</span><span class="p">:</span><span class="n">LogNorm</span><span class="p">,</span>       <span class="s1">'params'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'vmin'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s1">'vmax'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span><span class="p">}},</span>
                        <span class="s1">'symlog'</span><span class="p">:</span>   <span class="p">{</span><span class="s1">'function'</span><span class="p">:</span><span class="n">SymLogNorm</span><span class="p">,</span>    <span class="s1">'params'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'vmin'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="s1">'vmax'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s1">'linthresh'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">symLogLinThresh</span><span class="p">,</span> <span class="s1">'linscale'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">symLogLinScale</span><span class="p">}},</span>
                        <span class="s1">'powerlaw'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'function'</span><span class="p">:</span><span class="n">PowerNorm</span><span class="p">,</span>     <span class="s1">'params'</span><span class="p">:</span> <span class="p">{</span><span class="s1">'gamma'</span><span class="p">:</span><span class="n">colorbar</span><span class="o">.</span><span class="n">powerlaw</span><span class="p">}},</span>
                       <span class="p">}</span>
        
        <span class="n">colorbar</span><span class="o">.</span><span class="n">norm</span> <span class="o">=</span> <span class="n">colorbarDict</span><span class="p">[</span><span class="n">colorbar</span><span class="o">.</span><span class="n">scale</span><span class="p">][</span><span class="s1">'function'</span><span class="p">](</span><span class="o">**</span><span class="n">colorbarDict</span><span class="p">[</span><span class="n">colorbar</span><span class="o">.</span><span class="n">scale</span><span class="p">][</span><span class="s1">'params'</span><span class="p">])</span>
    
    
    <span class="c1">###########################################</span>
    <span class="c1">#            Legend properties            #</span>
    <span class="c1">###########################################</span>
    
    <span class="n">legend</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">(),</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">legendProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'legendProperties'</span><span class="p">):</span>
        
        <span class="c1"># Hide legend if no key is provided</span>
        <span class="k">if</span> <span class="n">legendProperties</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">hide</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">hide</span> <span class="o">=</span> <span class="kc">False</span>
     
        <span class="n">legend</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">titleSize</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">legendProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'titleSize'</span><span class="p">,</span> <span class="s1">'order'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">textsize</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">shadow</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">fancy</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">bg</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">legendProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'shadow'</span><span class="p">,</span> <span class="s1">'fancy'</span><span class="p">,</span> <span class="s1">'background'</span><span class="p">,</span> <span class="s1">'transparency'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">legendProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'loc'</span><span class="p">,</span> <span class="s1">'ncols'</span><span class="p">,</span> <span class="s1">'labelSize'</span><span class="p">,</span> <span class="s1">'labels'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s1">'best'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">layout</span><span class="o">.</span><span class="n">textsize</span><span class="p">,</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">])</span> 
        <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">position</span> <span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">legendProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'lineColor'</span><span class="p">,</span> <span class="s1">'markerEdgeColor'</span><span class="p">,</span> <span class="s1">'markerFaceColor'</span><span class="p">,</span> <span class="s1">'markerPosition'</span><span class="p">,</span> <span class="s1">'markerScale'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
        
        <span class="c1"># Checking that given parameters have the correct type</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span>               <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>      <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span>                <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>       <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgecolor</span>          <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgecolor</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">facecolor</span>          <span class="o">=</span> <span class="n">checkTypeAndChangeValueToList</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">facecolor</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">)</span>
        
        <span class="c1"># Set default color to black for scatter plots in legend </span>
        <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">mkfclr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">facecolor</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'scatter'</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">=</span> <span class="s1">'black'</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgecolor</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>       <span class="o">=</span> <span class="n">col</span>
            
            <span class="k">if</span> <span class="n">mkfclr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">facecolor</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span>
            
        <span class="c1"># If some text in legend is missing we add empty strings</span>
        <span class="n">llt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">llt</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="p">:</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">''</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">nplots</span><span class="o">-</span><span class="n">llt</span><span class="p">)</span>
            
    
    
    <span class="c1">########################################</span>
    <span class="c1">#           Output properties          #</span>
    <span class="c1">########################################</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">gatherThingsUp</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">isType</span><span class="p">(</span><span class="n">outputProperties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="s1">'outputProperties'</span><span class="p">):</span>
        <span class="n">output</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">overwrite</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">tight</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">transparent</span> <span class="o">=</span> <span class="n">setListFromDict</span><span class="p">(</span><span class="n">outputProperties</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">'outputName'</span><span class="p">,</span> <span class="s1">'overwrite'</span><span class="p">,</span> <span class="s1">'tightLayout'</span><span class="p">,</span> <span class="s1">'transparent'</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
    
    <span class="c1">############################################################################################</span>
    <span class="c1">#                         Set subplot and its overall properties                           #</span>
    <span class="c1">############################################################################################</span>
    
    <span class="c1"># Generate subplot</span>
    <span class="n">typ</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">typ</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">or</span> <span class="n">typ</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">numPlot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numPlot</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">numPlot</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">numPlot</span><span class="p">)</span>
        
    <span class="c1"># Set overall properties</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">verticalOffset</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">fontfamily</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">font</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">fontstyle</span><span class="o">=</span><span class="n">title</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>
        
    <span class="c1"># Set x and y labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    
    <span class="c1"># Place axes to the correct position</span>
    <span class="n">labelleft</span>       <span class="o">=</span> <span class="kc">False</span>
    <span class="n">labelright</span>      <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">if</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"right"</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">"right"</span><span class="p">)</span>
        <span class="n">labelright</span>  <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"left"</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">"left"</span><span class="p">)</span>
        <span class="n">labelleft</span>   <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"ValueError: given key 'yAxisPos' from dictionary axesProperties is neither 'right' nor 'left'. Please provide one of these values or nothing. Cheers !"</span><span class="p">)</span>
    
    <span class="c1"># Place axes to the correct position</span>
    <span class="n">labelbottom</span>     <span class="o">=</span> <span class="kc">False</span>
    <span class="n">labeltop</span>        <span class="o">=</span> <span class="kc">False</span>
    
    <span class="k">if</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"bottom"</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">"bottom"</span><span class="p">)</span>
        <span class="n">labelbottom</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"top"</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s2">"top"</span><span class="p">)</span>
        <span class="n">labeltop</span>    <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"ValueError: given key 'xAxisPos' from dictionary axesProperties is neither 'right' nor 'left'. Please provide one of these values or nothing. Cheers !"</span><span class="p">)</span>

    <span class="c1"># Set ticks properties for x and y axes</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="n">labelbottom</span><span class="p">,</span> <span class="n">labeltop</span><span class="o">=</span><span class="n">labeltop</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="n">yaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">direction</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="n">labelleft</span><span class="p">,</span> <span class="n">labelright</span><span class="o">=</span><span class="n">labelright</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span><span class="o">=</span><span class="n">layout</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zorder</span><span class="p">)</span>

    <span class="c1"># Setting a list of plots to provide to the user in the end</span>
    <span class="n">listPlots</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sct</span>       <span class="o">=</span> <span class="kc">None</span>
    
    <span class="c1"># List of handles for the legend</span>
    <span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">dtx</span><span class="p">,</span> <span class="n">dty</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">clr</span><span class="p">,</span> <span class="n">zrdr</span><span class="p">,</span> <span class="n">mrkr</span><span class="p">,</span> <span class="n">mrkrSz</span><span class="p">,</span> <span class="n">mrkrDgClr</span><span class="p">,</span> <span class="n">fllstl</span><span class="p">,</span> <span class="n">trnsprnc</span><span class="p">,</span> <span class="n">nfll</span><span class="p">,</span> <span class="n">lnstl</span><span class="p">,</span> <span class="n">lnwdth</span><span class="p">,</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">zorder</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgeColor</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">fillstyle</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">transparency</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">unfill</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span><span class="p">):</span>
        
        <span class="c1"># Set marker facecelor to "none" if marker must be unfilled</span>
        <span class="k">if</span> <span class="n">nfll</span><span class="p">:</span>
            <span class="n">facecolor</span> <span class="o">=</span> <span class="s2">"none"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">facecolor</span> <span class="o">=</span> <span class="n">clr</span>
        
        <span class="c1">#######################################################</span>
        <span class="c1">#            Deal with 'plot' type first              #</span>
        <span class="c1">#######################################################</span>
        
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'plot'</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">mrkrSz</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">lnstl</span><span class="o">==</span><span class="s1">'None'</span><span class="p">:</span>
                <span class="n">lnstl</span> <span class="o">=</span> <span class="s1">'-'</span>
            
            <span class="n">listPlots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dtx</span><span class="p">,</span> <span class="n">dty</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lbl</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">mrkr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zrdr</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">trnsprnc</span><span class="p">,</span>
                                       <span class="n">linestyle</span><span class="o">=</span><span class="n">lnstl</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">mrkrDgClr</span><span class="p">,</span>
                                       <span class="n">markersize</span><span class="o">=</span><span class="n">mrkrSz</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">lnwdth</span><span class="p">)</span>
                            <span class="p">)</span>
            <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="n">listPlots</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
            
        <span class="c1">#####################################################</span>
        <span class="c1">#           Deal with 'scatter' type then           #</span>
        <span class="c1">#####################################################</span>
        
        <span class="k">elif</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'scatter'</span><span class="p">:</span>
            
            <span class="c1"># Create a customisable marker object</span>
            <span class="n">markerObject</span> <span class="o">=</span> <span class="n">MarkerStyle</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="n">mrkr</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="n">fllstl</span><span class="p">)</span>
            
            <span class="n">sct</span>          <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">dtx</span><span class="p">,</span> <span class="n">dty</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">lbl</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">markerObject</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zrdr</span><span class="p">,</span> 
                                       <span class="n">cmap</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">norm</span><span class="p">,</span>  
                                       <span class="n">alpha</span><span class="o">=</span><span class="n">trnsprnc</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">mrkrSz</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="n">mrkrDgClr</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">nfll</span><span class="p">:</span>
                <span class="n">sct</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'none'</span><span class="p">)</span>
                
            <span class="n">listPlots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sct</span><span class="p">)</span>
        
    <span class="c1">#################################################</span>
    <span class="c1">#             Deal with the colorbar            #</span>
    <span class="c1">#################################################</span>
        
    <span class="c1"># If there is at least one 'scatter' or 'mix' type of plot and if the color bar should not be hidden</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">'plot'</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span>
        
        <span class="c1"># Make colorbar, set orientation, color, rotation and size</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sct</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">orientation</span><span class="p">)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
                           <span class="n">labelcolor</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">labelrotation</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">rotation</span><span class="p">,</span>
                           <span class="n">color</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        
        <span class="c1"># Set colorbar label</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">colorbar</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        
        <span class="c1"># Set colorbar ticks if provided</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">col</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            
        <span class="c1"># Set colorbar ticks labels if provided</span>
        <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s1">'vertical'</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">colorbar</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s1">'horizontal'</span><span class="p">:</span>
                <span class="n">col</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="c1">#######################################</span>
    <span class="c1">#           Deal with legend          #</span>
    <span class="c1">#######################################</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">legend</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span>
        
        <span class="c1"># Define a markerfirst argument to position the markers in the legend accordingly</span>
        <span class="k">if</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">position</span> <span class="o">==</span> <span class="s1">'right'</span><span class="p">:</span>
            <span class="n">markerfirst</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">markerfirst</span> <span class="o">=</span> <span class="kc">True</span>
        
        <span class="c1"># Plot legend before making changes and get legend handles</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">'size'</span><span class="p">:</span> <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">},</span> <span class="n">shadow</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">shadow</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">fancy</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">markerfirst</span><span class="o">=</span><span class="n">markerfirst</span><span class="p">,</span> 
                                               <span class="n">markerscale</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> 
                                               <span class="n">title</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="o">=</span><span class="n">legend</span><span class="o">.</span><span class="n">titleSize</span><span class="p">)</span>
        
        <span class="c1"># Map handles to the correct list shape</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cnt</span>            <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">legend</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">legend</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leg</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">[</span><span class="n">cnt</span><span class="p">])</span>
                <span class="n">cnt</span>   <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">legend</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">mkfclr</span><span class="p">,</span> <span class="n">mkeclr</span><span class="p">,</span> <span class="n">lc</span><span class="p">,</span> <span class="n">typ</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">handles</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">legend</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">):</span>
            
            <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'plot'</span><span class="p">,</span> <span class="s1">'mix'</span><span class="p">]:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">h</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>
                        <span class="n">h</span><span class="o">.</span><span class="n">set_markerfacecolor</span><span class="p">(</span><span class="n">mkfclr</span><span class="p">)</span>
                        <span class="n">h</span><span class="o">.</span><span class="n">set_markeredgecolor</span><span class="p">(</span><span class="n">mkeclr</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="k">elif</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">'scatter'</span><span class="p">:</span>
                    <span class="n">h</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">mkfclr</span><span class="p">)</span>
        
        <span class="c1"># Set zorder</span>
        <span class="n">leg</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">order</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">leg</span> <span class="o">=</span> <span class="kc">None</span>
                
    <span class="c1"># Set x and y scales        </span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="n">yaxis</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="n">xaxis</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        
    <span class="c1"># Define x and y axes limits</span>
    <span class="k">if</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">min</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="n">xaxis</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">yaxis</span><span class="o">.</span><span class="n">min</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">yaxis</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
        
    <span class="c1"># Hiding ticks labels if required</span>
    <span class="k">if</span> <span class="n">xaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">hideLabels</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>
    <span class="k">if</span> <span class="n">yaxis</span><span class="o">.</span><span class="n">ticks</span><span class="o">.</span><span class="n">hideLabels</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([])</span>


    <span class="c1">#################################</span>
    <span class="c1">#       Deal with output        #</span>
    <span class="c1">#################################</span>
    
    <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">output</span><span class="o">.</span><span class="n">overwrite</span> <span class="ow">and</span> <span class="n">isfile</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"File </span><span class="si">%s</span><span class="s2"> already exists but overwritting was disabled, thus writing was stopped. Please either provide a new file name, or set 'overwriting' key in outputProperties dictionary as True to overwrite the already existing file. Cheers !"</span> <span class="o">%</span><span class="n">output</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output</span><span class="o">.</span><span class="n">tight</span><span class="p">:</span>
                <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">'tight'</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bbox_inches</span> <span class="o">=</span> <span class="kc">None</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="n">bbox_inches</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">output</span><span class="o">.</span><span class="n">transparent</span><span class="p">)</span>
    
    <span class="c1">#plt.show()</span>
    <span class="k">return</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">listPlots</span><span class="p">,</span> <span class="n">leg</span><span class="p">,</span> <span class="n">col</span>
</code></pre></div>
</article>
<footer>
<div class="mt-20 mb-4 text-sm text-gray-700">© 2022, Wilfried Mercier Made with <a href="https://www.sphinx-doc.org">Sphinx 4.4.0</a></div>
</footer></main>
<button class="fixed bottom-0 right-0 z-20 opacity-0 p-4 m-4 tracking-wide bg-gray-900 text-gray-100 transition transform transform-gpu duration-500 translate-y-full" data-action="search#hideSnackbar" data-search-target="snackbar">
  Clear highlights
</button><div class="fixed hidden inset-0 bg-black bg-opacity-50" data-action="click-&gt;sidebar#close" data-sidebar-target="screen">
</div>
</div>
<script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
<script src="../../_static/jquery.js"></script>
<script src="../../_static/underscore.js"></script>
<script src="../../_static/doctools.js"></script>
<script src="../../_static/clipboard.min.js"></script>
<script src="../../_static/copybutton.js"></script>
<script src="../../_static/theme.3666d2347a4c66e5d7a8.js"></script>
</body>
</html>