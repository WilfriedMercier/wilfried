
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Miscellaneous &#8212; wilfried library 1.0 documentation</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Galaxy mass models" href="massModels.html" />
    <link rel="prev" title="Galaxy kinematics" href="kinematics.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">wilfried library 1.0 documentation</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Table of content
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../dependencies.html">
   Required dependencies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../makeLifeSimpler.html">
   makeLifeSimpler
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../utilities/index.html">
   Useful utilities
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../utilities/coloredMessages.html">
     Colored messages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../utilities/dict.html">
     Dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../utilities/io.html">
     Input/Output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../utilities/list.html">
     List manipulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../utilities/strings.html">
     Strings manipulation
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../utilities/plotUtilities/index.html">
     Plot utilities
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../utilities/plotUtilities/hst.html">
       HST related plots
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="index.html">
   Galaxy module
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="angularMomentum.html">
     Galaxies angular momentum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cosmology.html">
     Cosmology computations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="kinematics.html">
     Galaxy kinematics
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Miscellaneous
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="massModels.html">
     Galaxy mass models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="models.html">
     Galaxy models
    </a>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="morphology/index.html">
     Galaxies morphology
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="morphology/SersicFlux.html">
       Sersic fluxes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="morphology/Morpho.html">
       Morphological parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="morphology/Thickness.html">
       Galaxies thickness
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="morphology/MUSE.html">
       MUSE related functions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="morphology/Other.html">
       Other Sersic related functions
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="photometry/index.html">
     Galaxies photometry
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="photometry/Fluxes.html">
       Fluxes, colour excess and attenuation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="photometry/Masses_SFR.html">
       Masses and SFR estimates
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../galfit/index.html">
   Galfit module
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../galfit/galfit.html">
     Galfit auto-routines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../galfit/models.html">
     Galfit models
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/galaxy/misc.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/WilfriedMercier/wilfried"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        <a class="edit-button" href="https://github.com/WilfriedMercier/wilfried/edit/master/galaxy/misc.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="module-galaxy.misc">
<span id="miscellaneous"></span><h1>Miscellaneous<a class="headerlink" href="#module-galaxy.misc" title="Permalink to this headline">¶</a></h1>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Miscellaneous functions related to galaxy computations.</p>
<dl class="py function">
<dt id="galaxy.misc.PSFconvolution2D">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">PSFconvolution2D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arcsecToGrid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'FWHMX':</span> <span class="pre">0.8,</span> <span class="pre">'FWHMY':</span> <span class="pre">0.8,</span> <span class="pre">'name':</span> <span class="pre">'Gaussian2D',</span> <span class="pre">'sigmaX':</span> <span class="pre">None,</span> <span class="pre">'sigmaY':</span> <span class="pre">None,</span> <span class="pre">'unit':</span> <span class="pre">'arcsec'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#PSFconvolution2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.PSFconvolution2D" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Convolve using fast FFT a 2D array with a pre-defined (2D) PSF.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>How to use</strong></p>
<p>Best practice is to provide the PSF model FWHM or sigma in arcsec, and the image pixel element resolution (arcsecToPixel), so that the fonction can convert correctly the PSF width in pixels.
You can provide either the FWHM or sigma. If both are given, sigma is used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>2D ndarray</em>) – data to be convolved with the PSF</p></li>
<li><p><strong>arcsecToGrid</strong> (<em>float</em>) – (<strong>Optional</strong>) conversion factor from arcsec to the grid pixel size, that is the width and height of a single pixel in the X and Y grids. Default is the pixel size of HST-ACS images (0.03”/px).</p></li>
<li><p><strong>model</strong> (<em>dict</em>) – (<strong>Optional</strong>) dictionnary of the PSF (and its parameters) to use for the convolution. Default is a (0, 0) centred radial gaussian (muX=muY=0 and sigmaX=sigmaY) with a FWHM corresponding to that of MUSE (~0.8”~4 MUSE pixels). For now, only 2D Gaussians are accepted as PSF.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to print text on stdout or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new convolved image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray[float]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – <ul class="simple">
<li><p>if unit key in <strong>model</strong> dict is not a valid astropy unit</p></li>
<li><p>if the PSF is not a 2D Gaussian model</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.checkAndComputeIe">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">checkAndComputeIe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ie</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">re</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noError</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#checkAndComputeIe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.checkAndComputeIe" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Check whether Ie is provided. If not, but the magnitude and magnitude offset are, it computes it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bn</strong> (<em>float</em>) – bn factor appearing in the Sersic profile (see below)</p></li>
<li><p><strong>Ie</strong> (<em>float</em>) – intensity at effective radius</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – total integrated magnitude</p></li>
<li><p><strong>n</strong> (<em>int</em><em> or </em><em>float</em>) – Sersic index</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – magnitude offset</p></li>
<li><p><strong>re</strong> (<em>float</em>) – half-light/effective radius</p></li>
<li><p><strong>noError</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to not raise an error or not when data is missing to compute the intensity. If True, None is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ie if it could be computed or already existed, or None if <strong>noError</strong> flag is set to True.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int or float or None</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if neither Ie, nor mag and offset are provided</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The bn factor is defined by the following equation</p>
<div class="math">
<p><img src="../_images/math/8d279bae4c0e3472487c92a6b9c11fba49228082.png" alt="2\gamma(2n, b_n) = \Gamma(2n)"/></p>
</div></div>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.check_bns">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">check_bns</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">listn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listbn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#check_bns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.check_bns" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Given a list of bn values, check those which are not given (i.e. equal to None), and compute their value using the related Sersic index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>listbn</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – list of bn values</p></li>
<li><p><strong>listn</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>float</em><em>]</em>) – list of Sersic indices</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of bn values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.compute_bn">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">compute_bn</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#compute_bn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.compute_bn" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Compute the value of bn used in the definition of a Sersic profile</p>
<div class="math">
<p><img src="../_images/math/8d279bae4c0e3472487c92a6b9c11fba49228082.png" alt="2\gamma(2n, b_n) = \Gamma(2n)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em><em> or </em><em>float</em>) – Sersic index of the profile</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bn</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.fromStructuredArrayOrNot">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">fromStructuredArrayOrNot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magD</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noStructuredArray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#fromStructuredArrayOrNot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.fromStructuredArrayOrNot" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Store values of the disk magnitude, the bulge magnitude, the disk effective radius and the bulge effective radius either directly from the given values or from a numpy structured array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gal</strong> (<em>structured ndarray</em>) – structured array with data for all the galaxies. The required column names are ‘R_d_GF’ (re for the disk component), ‘R_b_GF’ (re for the bulge component), ‘Mag_d_GF’ (the total integrated magnitude for the disk component), ‘Mag_b_GF’ (the total integrated magnitude for the bulge component).</p></li>
<li><p><strong>magB</strong> (<em>float</em><em> or </em><em>list</em><em>(</em><em>float</em><em>)</em>) – total magnitude of the bulge component of the galaxies</p></li>
<li><p><strong>magD</strong> (<em>float</em><em> or </em><em>list</em><em>(</em><em>float</em><em>)</em>) – total magnitude of the disk component of the galaxies</p></li>
<li><p><strong>Rb</strong> (<em>float</em><em> or </em><em>list</em><em>(</em><em>float</em><em>)</em>) – half-light radius of the bulge components of the galaxies</p></li>
<li><p><strong>Rd</strong> (<em>float</em><em> or </em><em>list</em><em>(</em><em>float</em><em>)</em>) – half-light radius of the disk components of the galaxies</p></li>
<li><p><strong>noStructuredArray</strong> (<em>bool</em>) – if False, the structured array gal will be used. If False, values of the magnitudes and half-light radii of the two components must be given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the disk magnitude, the bulge magnitude, the disk effective radius and the bulge effective radius</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float, float, float, float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.intensity_at_re">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">intensity_at_re</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">re</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#intensity_at_re"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.intensity_at_re" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Compute the intensity of a given Sersic profile with index n at the position of the half-light radius re. This assumes to know the integrated magnitude of the profile, as well as the offset used for the magnitude definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag</strong> (<em>float</em>) – total integrated magnitude of the profile</p></li>
<li><p><strong>n</strong> (<em>int</em><em> or </em><em>float</em>) – Sersic index of the given profile</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – magnitude offset used in the defition of the magnitude system</p></li>
<li><p><strong>re</strong> (<em>float</em>) – effective (half-light) radius</p></li>
<li><p><strong>bn</strong> (<em>float</em>) – (<strong>Optional</strong>) bn factor appearing in the Sersic profile defined as $2gamma(2n, bn) = Gamma(2n)$. If None, its value will be computed from n.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the intensity at re</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.mergeModelsIntoOne">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">mergeModelsIntoOne</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">listX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">listModels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixWidth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixHeight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#mergeModelsIntoOne"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.mergeModelsIntoOne" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Sum the contribution of different models with distorted X and Y grids into a single image with a regular grid.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>How to use</strong></p>
<p>Provide the X and Y grids for each model as well as the intensity maps.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>pixWidth and pixHeight parameters are quite important as they will be used to define the pixel scale of the new regular grid. Additonally, all data points of every model falling inside a given pixel will be added to this pixel contribution.</p>
<p>In principle, one should give the pixel scale of the original array (before sky projection was applied).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ndarray</strong><strong>] </strong><strong>listX</strong> (<em>list</em><em>[</em><em>2D</em>) – list of X arrays for each model</p></li>
<li><p><strong>ndarray</strong><strong>] </strong><strong>listY</strong> (<em>list</em><em>[</em><em>2D</em>) – list of Y arrays for each model</p></li>
<li><p><strong>ndarray</strong><strong>] </strong><strong>listModels</strong> (<em>list</em><em>[</em><em>2D</em>) – list of intensity maps for each model</p></li>
<li><p><strong>pixWidth</strong> (<em>float</em>) – width (x-axis size) of a single pixel. With numpy meshgrid, it is possible to generate grids with Nx pixels between xmin and xmax values, so that each pixel would have a width of (xmax-xmin)/Nx.</p></li>
<li><p><strong>pixHeight</strong> (<em>float</em>) – height (y-axis size) of a single pixel. With numpy meshgrid, it is possible to generate grids with Ny pixels between ymin and ymax values, so that each pixel would have a height of (ymax-ymin)/Ny.</p></li>
<li><p><strong>xlim</strong> (<em>2-tuple</em><em>[</em><em>float</em><em>]</em>) – (<strong>Optional</strong>) lower and upper bounds (in that order) for the x-axis. If None, a symmetric grid in X is done, using the maximum absolute X value found.</p></li>
<li><p><strong>ylim</strong> (<em>2-tuple</em><em>[</em><em>float</em><em>]</em>) – (<strong>Optional</strong>) lower and upper bounds (in that order) for the y-axis. If None, a symmetric grid in Y is done, using the maximum absolute Y value found.</p></li>
</ul>
</dd>
<dt class="field-even">Results</dt>
<dd class="field-even"><p>a new X grid, a new Y grid and a new model intensity map with the contribution of every model summed up</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray, 2D ndarray, 2D ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – if xlim or ylim are neither None, nor a tuple, nor a list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.projectModel2D">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">projectModel2D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splineOrder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillVal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#projectModel2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.projectModel2D" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Project onto the sky a 2D model of a galaxy viewed face-on.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>Sky projection is used with scipy ndimage functions. Two projections are applied (in this order):</dt><dd><ul class="simple">
<li><p>inclination: the 2D model is rotated along the vertical axis passing through the centre of the image</p></li>
<li><p>PA rotation: the (inclined) model is rotated clock-wise in the sky plane</p></li>
</ul>
</dd>
</dl>
<p>If you do not desire to apply one of the following coordinate transform, either do not provide it, or let it be 0.
By default, no transform whatsoever is applied.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>2D ndarray</em>) – intensity map of the model</p></li>
<li><p><strong>inclination</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) inclination of the galaxy on the sky in <strong>degrees</strong></p></li>
<li><p><strong>fillVal</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) value used to filled pixels with missing data</p></li>
<li><p><strong>PA</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) position angle of the galaxy on the sky in degrees. Generally, this number is given between -90° and +90°</p></li>
<li><p><strong>splineOrder</strong> (<em>int</em>) – (<strong>Optional</strong>) order of the spline used to interpolate values at new sky coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new image (intensity map) projected onto the sky with interpolated values at new coordinate location</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if PA not in [-90°, +90°] range or if model image is not 2-dimensional</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.realGammainc">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">realGammainc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#realGammainc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.realGammainc" title="Permalink to this definition">¶</a></dt>
<dd><p>‘
.. codeauthor:: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</p>
<p>Unnormalised lower incomplete gamma function</p>
<div class="math">
<p><img src="../_images/math/b3438afd8183b26a945d50f5faaa526afe1bb419.png" alt="\gamma(a, x) = \int_0^x dt~t^{a-1} e^{-t}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>int</em><em> or </em><em>float</em>) – power of the gamma function</p></li>
<li><p><strong>x</strong> (<em>int</em><em> or </em><em>float</em>) – upper bound of the integral</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the incomplete gamma function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.rotateGalaxy">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">rotateGalaxy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PA</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splineOrder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitIn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillVal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#rotateGalaxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.rotateGalaxy" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Apply PA rotation to a galaxy image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>2D ndarray</em>) – intensity map of the galaxy model</p></li>
<li><p><strong>fillVal</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) value to fill pixels which may become empty</p></li>
<li><p><strong>fitIn</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to resize the image to fit it in or not. If False a new image is generated with the same dimensions.</p></li>
<li><p><strong>PA</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) rotation angle to apply (counted clock-wise in degrees). Default is 0 so that no rotation is applied.</p></li>
<li><p><strong>splineOrder</strong> (<em>int</em>) – (<strong>Optional</strong>) order of the spline used to compute the intensity value at new pixel location</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new image of a galaxy rotated by a certain angle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if model image is not 2-dimensional</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galaxy.misc.tiltGalaxy">
<code class="sig-prename descclassname"><span class="pre">galaxy.misc.</span></code><code class="sig-name descname"><span class="pre">tiltGalaxy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclination</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splineOrder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillVal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/misc.html#tiltGalaxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galaxy.misc.tiltGalaxy" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried&#46;mercier&#37;&#52;&#48;irap&#46;omp&#46;eu">wilfried<span>&#46;</span>mercier<span>&#64;</span>irap<span>&#46;</span>omp<span>&#46;</span>eu</a>&gt;</em></p>
<p>Tilt a galaxy image around the South-North axis (assumed vertical) passing through the image centre.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>2D ndarray</em>) – intensity map of the galaxy model</p></li>
<li><p><strong>fillVal</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) value to fill pixels which may become empty</p></li>
<li><p><strong>fitIn</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to resize the image to fit it in or not. If False, a new image is generated with the same dimensions.</p></li>
<li><p><strong>inclination</strong> – (<strong>Optional</strong>) rotation angle to apply (counted clock-wise in degrees). Is 0, no rotation is applied.</p></li>
<li><p><strong>splineOrder</strong> (<em>int</em>) – (<strong>Optional</strong>) order of the spline used to compute the intensity value at new pixel location</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new image of a galaxy tilted by some angle around the vertical axis passing through the image centre</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if model image is not 2-dimensional</p>
</dd>
</dl>
</dd></dl>

</div>


              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="kinematics.html" title="previous page">Galaxy kinematics</a>
    <a class='right-next' id="next-link" href="massModels.html" title="next page">Galaxy mass models</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Wilfried Mercier<br/>
        
            &copy; Copyright 2021, Wilfried Mercier.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>