
<!DOCTYPE html>

<html lang="en">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Galaxy models | wilfried library 1.0 documentation</title>
<link href="../_static/pygments.css" rel="stylesheet"/>
<link href="../_static/theme.313ea551d1799b2102b1.css" rel="stylesheet"/>
<link href="../_static/plot_directive.css" rel="stylesheet"/>
<link href="../_static/copybutton.css" rel="stylesheet"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="morphology/index.html" rel="next" title="Galaxies morphology"/>
<link href="massModels.html" rel="prev" title="Galaxy mass models"/>
</head>
<body class="antialiased text-gray">
<div class="h-screen xl:grid xl:grid-layout" data-action="keydown@window-&gt;search#focus" data-controller="sidebar search" id="page">
<a class="block text-xl bg-white py-4 z-20 absolute top-0 h-18 inset-x-0 text-center transform -translate-y-full focus:translate-y-0 focus:outline-none transition-transform duration-75" href="#galaxy-models" title="Skip navigation links">Skip to content</a>
<header class="grid-area-header z-10 h-14 sm:h-18">
<div class="bg-gray-dark shadow-md flex items-center h-full xl:px-2 relative"><div class="flex items-center">
<button class="xl:hidden h-14 w-14 sm:h-18 sm:w-18 leading-14 sm:leading-18 text-gray-100 hover:bg-gray-700 hover:text-brand focus:outline-none focus:bg-gray-700 focus:text-brand" data-action="sidebar#open" data-sidebar-target="hamburger">
<span class="sr-only">Open navigation menu</span>
<svg aria-hidden="true" class="fill-current h-8 w-8" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg>
</button><a aria-label="Back to homepage" class="hover:bg-gray-700 focus:bg-gray-700 focus:outline-none tooltipped tooltipped-sw" href="../index.html"><span class="hidden lg:inline-block shrink-0 font-medium text-gray-100 mx-5 leading-14 sm:leading-18 tracking-wider">wilfried library 1.0 documentation</span>
</a></div><div class="flex justify-end items-center flex-1"><form action="../search.html" class="flex print:hidden justify-between items-center leading-14 sm:leading-18 md:ml-4 bg-gray-dark text-gray-300 focus-within:bg-gray-50 focus-within:text-gray-800 focus-within:absolute focus-within:inset-x-0 focus-within:top-0 md:focus-within:w-full md:focus-within:static" data-action="click-&gt;search#focusSearchInput" id="searchbox" method="get">
<button aria-label="Get search results" class="text-inherit h-14 w-14 sm:h-18 sm:w-18" tabindex="-1">
<svg aria-hidden="true" class="fill-current stroke-current h-8 w-8" stroke-width="0.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
</button>
<input aria-label="Search the docs" class="pr-2 bg-transparent text-inherit focus:outline-none w-0 md:w-auto focus:w-full transition-all duration-100" data-search-target="searchInput" id="search-input" name="q" placeholder="Search the docs" type="search"/>
</form></div>
</div>
</header>
<aside class="grid-area-sidebar h-full fixed xl:relative inset-y-0 left-0 z-20 xl:z-0 print:hidden overflow-y-auto transition-all transform transform-gpu -translate-x-full opacity-0 duration-300 xl:translate-x-0 xl:opacity-100" data-sidebar-target="sidebar">
<nav class="h-full overflow-y-auto bg-white text-gray-600 pt-8 flex flex-col" role="navigation">
<div class="nav-toc flex-1 pl-6"><ul class="current">
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../dependencies.html">Required dependencies</a></div></li>
<li class="toctree-l1"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../makeLifeSimpler.html">makeLifeSimpler</a></div></li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/index.html">Useful utilities</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/coloredMessages.html">Colored messages</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/coloredMessages.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/coloredMessages.html#example">Example</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/coloredMessages.html#module-utilities.coloredMessages">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/dict.html">Dictionaries</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/dict.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/dict.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/dict.html#module-utilities.dictionaries">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/io.html">Input/Output</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/io.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/io.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/io.html#module-utilities.io">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/list.html">List manipulations</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/list.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/list.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/list.html#module-utilities.lists">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/strings.html">Strings manipulation</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/strings.html#list-of-available-functions">List of available functions</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/strings.html#examples">Examples</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/strings.html#module-utilities.strings">Documentation</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/plotUtilities/index.html">Plot utilities</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/plotUtilities/asManyHists.html">Histograms</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/plotUtilities/hst.html">Galfit related plots</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/plotUtilities/misc.html">Miscellaneous</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../utilities/plotUtilities/singleContour.html">Contours</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current expanded"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="index.html">Galaxy module</a></div><ul class="current">
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="angularMomentum.html">Galaxies angular momentum</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="cosmology.html">Cosmology computations</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="geometry.html">Galaxies angular momentum</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="kinematics.html">Galaxy kinematics</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="misc.html">Miscellaneous</a></div></li>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="massModels.html">Galaxy mass models</a></div></li>
<li class="toctree-l2 current expanded"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="current reference internal" data-action="click-&gt;sidebar#close" href="#">Galaxy models</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="#d-profiles">1D profiles</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="#id1">2D profiles</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="morphology/index.html">Galaxies morphology</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="morphology/index.html#functions-are-split-into-the-following-modules">Functions are split into the following modules:</a></div></li>
</ul>
</li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="photometry/index.html">Galaxies photometry</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="photometry/index.html#functions-are-split-into-the-following-modules">Functions are split into the following modules:</a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../galfit/index.html">Galfit module</a></div><ul>
<li class="toctree-l2"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../galfit/galfit.html">Galfit auto-routines</a></div></li>
<li class="toctree-l2"><div class="nav-link"><svg class="expand" data-action="click-&gt;sidebar#expand keydown-&gt;sidebar#expandKeyPressed" tabindex="0" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg><a class="reference internal" data-action="click-&gt;sidebar#close" href="../galfit/models.html">Galfit models</a></div><ul>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../galfit/models.html#miscellaneous">Miscellaneous</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../galfit/models.html#galfit-profiles">Galfit profiles</a></div></li>
<li class="toctree-l3"><div class="nav-link"><a class="reference internal" data-action="click-&gt;sidebar#close" href="../galfit/models.html#galfit-additional-tags">Galfit additional tags</a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<button class="text-4xl text-gray-800 p-4 bottom-0 hover:text-brand xl:hidden focus:text-brand self-center" data-action="" title="Close navigation menu">
<span class="sr-only">Close navigation menu</span>
<svg aria-hidden="true" class="fill-current stroke-current h-6 w-6" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</aside>
<main class="px-10 xl:ml-fluid grid-area-main overflow-y-auto flex flex-col h-full mx-0 md:mx-auto xl:mr-0" data-action="scroll-&gt;scroll#showButton" data-controller="scroll"><nav aria-label="breadcrumbs" class="print:hidden mt-12 text-sm text-gray-light" role="navigation">
<a class="text-gray-light text-sm hover:text-gray-dark font-medium focus:text-gray-dark" href="../index.html">wilfried library 1.0 documentation</a>
<span class="mr-1">/</span><a class="text-gray-light text-sm hover:text-gray-dark" href="index.html">Galaxy module</a>
<span class="mr-1">/</span><span aria-current="page">Galaxy models</span>
</nav>
<article class="flex-1" role="main">
<section id="module-galaxy.models">
<span id="galaxy-models"></span><h1>Galaxy models<a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#module-galaxy.models">¶</a></h1>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Useful functions for galaxy modelling and other related computation.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#d-profiles" id="id3">1D profiles</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id4">2D profiles</a></p></li>
</ul>
</div>
<section id="d-profiles">
<h2><a class="toc-backref" href="#id3">1D profiles</a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#d-profiles">¶</a></h2>
<p>A collection of 1D surface brightness profiles.</p>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.bulge">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">bulge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">re</span></em>, <em class="sig-param"><span class="n">b4</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ie</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#bulge"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.bulge">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Computes the value of the intensity of a de Vaucouleur bulge at position r defined as</p>
<div class="math">
<p><img alt="\Sigma(r) = I_{\rm{e}} e^{\left [ \left (r/R_{\rm{e}} \right )^{1/4} - 1 \right ]}," src="../_images/math/027a7f315801e717c331f175b1542c68c3a96e1a.png"/></p>
</div><p>with <img alt="R_{\rm{e}}" class="math" src="../_images/math/02e9ba95a6448d0edb31eb6bf64c5316bd908c36.png"/> the effective radius and <img alt="I_{\rm{e}}" class="math" src="../_images/math/bba8df14c232c179be27ba94d5f12f9fb6625ca4.png"/> the surface brightness at the effective radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – position at which the profile is computed</p></li>
<li><p><strong>re</strong> (<em>float</em>) – half-light radius</p></li>
<li><p><strong>b4</strong> (<em>float</em>) – (<strong>Optional</strong>) b4 factor appearing in the Sersic profile. If None, its value will be computed.</p></li>
<li><p><strong>Ie</strong> (<em>float</em>) – (<strong>Optional</strong>) surface brightness at half-light radius</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – (<strong>Optional</strong>) total integrated magnitude used to compute Ie if not given</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – (<strong>Optional</strong>) magnitude offset in the magnitude system used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>surface brightness</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.exponential_disk">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">exponential_disk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">re</span></em>, <em class="sig-param"><span class="n">b1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ie</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#exponential_disk"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.exponential_disk">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Computes the value of the intensity of an exponential disk at position r defined as</p>
<div class="math">
<p><img alt="\Sigma(r) = I_{\rm{e}} e^{\left [ r/R_{\rm{e}} - 1 \right ]}," src="../_images/math/f9e0df37c6c4f100ea98ddfc02d85bb45fa2cde0.png"/></p>
</div><p>with <img alt="R_{\rm{e}}" class="math" src="../_images/math/02e9ba95a6448d0edb31eb6bf64c5316bd908c36.png"/> the effective radius and <img alt="I_{\rm{e}}" class="math" src="../_images/math/bba8df14c232c179be27ba94d5f12f9fb6625ca4.png"/> the surface brightness at the effective radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – position at which the profile is computed</p></li>
<li><p><strong>re</strong> (<em>float</em>) – half-light radius</p></li>
<li><p><strong>b1</strong> (<em>float</em>) – (<strong>Optional</strong>) b1 factor appearing in the Sersic profile. If None, its value will be computed.</p></li>
<li><p><strong>Ie</strong> (<em>float</em>) – (<strong>Optional</strong>) surface brightness at half-light radius</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – (<strong>Optional</strong>) total integrated magnitude used to compute Ie if not given</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – (<strong>Optional</strong>) magnitude offset in the magnitude system used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>surface brightness</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.hernquist">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">hernquist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">M</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#hernquist"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.hernquist">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Hernquist profile defined as</p>
<div class="math">
<p><img alt="\rho(r) = \frac{M_{\rm{b}}}{2\pi} \frac{a}{r} (r + a)^{-3}," src="../_images/math/0ea7af6ab6445e28080dc5a58db8f6d734f3fb8f.png"/></p>
</div><p>with <img alt="M_{\rm{b}}" class="math" src="../_images/math/bd6ff32bf2265a980708308f76a14198f8dccddd.png"/> the total mass and <img alt="a" class="math" src="../_images/math/b3e65e3b6408fcfa00452530b73f55d1755f9965.png"/> the scale radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>int</em><em> or </em><em>float</em>) – scale radius</p></li>
<li><p><strong>M</strong> (<em>int</em><em> or </em><em>float</em>) – total mass</p></li>
<li><p><strong>r</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>ndarray</em><em>[</em><em>int</em><em>] or </em><em>ndarray</em><em>[</em><em>float</em><em>]</em>) – radial distance(s) where to compute the Hernquist profile. Unit must be the same as <strong>a</strong>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Hernquist profile evaluated at the given distance(s). Unit is that of <strong>M</strong>/<strong>a^3</strong>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or ndarray[float]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – if <strong>r</strong>, <strong>M</strong> and <strong>a</strong> are neither int, nor float</p></li>
<li><p><strong>ValueError</strong> – if np.any(<strong>r</strong>) &lt; 0, if <strong>a</strong> &lt;= 0 or if <strong>M</strong> &lt; 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.nfw">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">nfw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">c</span></em>, <em class="sig-param"><span class="n">rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#nfw"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.nfw">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>NFW profile defined as</p>
<div class="math">
<p><img alt="\rho(r) = \delta_{\rm{c}} \rho_{\rm{crit}} (r/r_{\rm{s}})^{-1} (1 + r/r_{\rm{s}})^{-2}," src="../_images/math/04841d3f2cf16bcd3a2bedcb429859ae0b851ce3.png"/></p>
</div><p>with <img alt="r_{\rm{s}} = r_{200} / c" class="math" src="../_images/math/23d1c822dbcd337d3b73b96f0ec8804aa5865ddd.png"/> the halo scale radius, with <img alt="r_{200}" class="math" src="../_images/math/e5b134b7e0d387972aada359b470495d2470564d.png"/> the virial radius where the mean overdensity is equal to 200, <img alt="c" class="math" src="../_images/math/d520a12f1579170834c32ad5f656de081bbb36fe.png"/> the halo concentration, <img alt="\rho_{\rm{crit}} = 3 H_0^2 / (8\pi G)" class="math" src="../_images/math/904bb58c7203e3894aa2f07121e45da55d7fe26e.png"/> the Universe closure density, and <img alt="\delta_{\rm{c}}" class="math" src="../_images/math/82b7bda044c5edd7b3cf8a6d7edd6abb85d29b69.png"/> the halo overdensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>int</em><em> or </em><em>float</em>) – halo concentration</p></li>
<li><p><strong>r</strong> (<em>int</em><em> or </em><em>float</em><em> or </em><em>ndarray</em><em>[</em><em>int</em><em>] or </em><em>ndarray</em><em>[</em><em>float</em><em>]</em>) – radial distance(s) where to compute the profile. Unit must be the same as rs.</p></li>
<li><p><strong>rs</strong> (<em>int</em><em> or </em><em>float</em>) – scale radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>NFW profile evaluated at the given distance. Unit is that of a 3D mass density in SI (i.e. kg/m^3).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float or ndarray[float]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – if <strong>r</strong>, <strong>c</strong> and <strong>rs</strong> are neither int, nor float</p></li>
<li><p><strong>ValueError</strong> – if np.any(<strong>r</strong>)&lt;0, if c&lt;=0, or if rs&lt;=0</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.sersic_profile">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">sersic_profile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">re</span></em>, <em class="sig-param"><span class="n">Ie</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bn</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#sersic_profile"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.sersic_profile">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>General Sersic profile defined as</p>
<div class="math">
<p><img alt="\Sigma(r) = I_{\rm{e}} e^{\left [ \left (r/R_{\rm{e}} \right )^{1/n} - 1 \right ]}," src="../_images/math/c873b073f13ba451278f2e559fa41be54b648223.png"/></p>
</div><p>with <img alt="R_{\rm{e}}" class="math" src="../_images/math/02e9ba95a6448d0edb31eb6bf64c5316bd908c36.png"/> the effective radius, <img alt="I_{\rm{e}}" class="math" src="../_images/math/bba8df14c232c179be27ba94d5f12f9fb6625ca4.png"/> the surface brightness at the effective radius and <img alt="n" class="math" src="../_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png"/> the Sersic index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compute it with:</p>
<blockquote>
<div><ul class="simple">
<li><p>n, re and Ie</p></li>
<li><p>n, re, mag and offset</p></li>
</ul>
</div></blockquote>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – position at which the profile is computed</p></li>
<li><p><strong>re</strong> (<em>float</em>) – half-light radius</p></li>
<li><p><strong>bn</strong> (<em>float</em>) – (<strong>Optional</strong>) bn factor appearing in the Sersic profile. If None, its value will be computed.</p></li>
<li><p><strong>Ie</strong> (<em>float</em>) – (<strong>Optional</strong>) surface brightness at half-light radius</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – (<strong>Optional</strong>) total integrated magnitude used to compute Ie if not given</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – (<strong>Optional</strong>) magnitude offset in the magnitude system used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>surface brightness</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="id1">
<h2><a class="toc-backref" href="#id4">2D profiles</a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#id1">¶</a></h2>
<p>A collection of 2D models of surface brightness profiles with or without inclination effects and PSF convolution.</p>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.bulgeDiskOnSky">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">bulgeDiskOnSky</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nx</span></em>, <em class="sig-param"><span class="n">ny</span></em>, <em class="sig-param"><span class="n">Rd</span></em>, <em class="sig-param"><span class="n">Rb</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magD</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magB</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsetD</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offsetB</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inclination</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">PA</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">combine</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">PSF</span><span class="o">=</span><span class="default_value">{'FWHMX': 0.8, 'FWHMY': 0.8, 'name': 'Gaussian2D', 'sigmaX': None, 'sigmaY': None, 'unit': 'arcsec'}</span></em>, <em class="sig-param"><span class="n">noPSF</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">arcsecToGrid</span><span class="o">=</span><span class="default_value">0.03</span></em>, <em class="sig-param"><span class="n">fineSampling</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">samplingZone</span><span class="o">=</span><span class="default_value">{'dx': 2, 'dy': 2, 'where': 'centre'}</span></em>, <em class="sig-param"><span class="n">skipCheck</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#bulgeDiskOnSky"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.bulgeDiskOnSky">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Generate a bulge + (sky projected) disk 2D model (with PSF convolution).</p>
<p class="rubric"><strong>How to use</strong></p>
<p>Apart from the mandatory inputs, it is necessary to provide</p>
<ul class="simple">
<li><p>an intensity at Re for each profile</p></li>
<li><p>a total magnitude value for each profile and a corresponding magnitude offset per profile (to convert from magnitudes to intensities)</p></li>
</ul>
<p class="rubric"><strong>Infos about sampling</strong> </p>
<p><strong>fineSampling</strong> parameter can be used to rebin the data. The shape of the final image will depend on the samplingZone used</p>
<ul class="simple">
<li><p>if the sampling is performed everywhere (‘where’ keyword in <strong>samplingZone</strong> equal to ‘all’), the final image will have dimensions (<strong>nx*fineSampling</strong>, <strong>ny*fineSampling</strong>)</p></li>
<li><p>if the sampling is performed around the centre (‘where’ equal to ‘centre’), the central part is over-sampled, but needs to be binned in the end so that pixels have the same size in the central part and around. Thus, the final image will have the dimension (<strong>nx</strong>, <strong>ny</strong>).</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Rd</strong> and <strong>Rb</strong> should be given in pixel units.</p>
<p>If you provide them in arcsec, you must update the <strong>arcsecToGrid</strong> value to 1 (since 1 pixel will be equal to 1 arcsec).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx</strong> (<em>int</em>) – size of the model for the x-axis</p></li>
<li><p><strong>ny</strong> (<em>int</em>) – size of the model for the y-axis</p></li>
<li><p><strong>Rb</strong> (<em>float</em>) – bulge half-light radius. Best practice is to provide it in pixels.</p></li>
<li><p><strong>Rd</strong> (<em>float</em>) – disk half-light radius. Best practice is to provide it in pixels.</p></li>
<li><p><strong>arcsecToGrid</strong> (<em>float</em>) – (<strong>Optional</strong>) pixel size conversion in arcsec/pixel, used to convert the FWHM/sigma from arcsec to pixel</p></li>
<li><p><strong>Ib</strong> (<em>float</em>) – (<strong>Optional</strong>) bulge intensity at (bulge) half-light radius. If not provided, magnitude and magnitude offset must be given instead.</p></li>
<li><p><strong>Id</strong> (<em>float</em>) – (<strong>Optional</strong>) disk intensity at (disk) half-light radius. If not provided, magnitude and magnitude offset must be given instead.</p></li>
<li><p><strong>inclination</strong> ((<strong>Optional</strong>) int or float) – (<strong>Optional</strong>) disk inclination on sky. Generally given between -90° and +90°. Value must be given in degrees.</p></li>
<li><p><strong>magB</strong> (<em>float</em>) – (<strong>Optional</strong>) bulge total magnitude</p></li>
<li><p><strong>magD</strong> (<em>float</em>) – (<strong>Optional</strong>) disk total magnitude</p></li>
<li><p><strong>offsetB</strong> (<em>float</em>) – (<strong>Optional</strong>) bulge magnitude offset</p></li>
<li><p><strong>offsetD</strong> (<em>float</em>) – (<strong>Optional</strong>) disk magnitude offset</p></li>
<li><p><strong>noPSF</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to not perform PSF convolution or not</p></li>
<li><p><strong>PA</strong> (<em>int</em><em> or </em><em>float</em>) – disk position angle (in degrees)</p></li>
<li><p><strong>fineSampling</strong> (<em>int</em><em>(</em><em>&gt;0</em><em>)</em>) – fine sampling for the pixel grid used to make high resolution models. For instance, a value of 2 means that a pixel will be split into two subpixels.</p></li>
<li><p><strong>PSF</strong> (<em>dict</em>) – (<strong>Optional</strong>) Dictionnary of the PSF (and its parameters) to use for the convolution. For now, only 2D Gaussians are accepted as PSF.</p></li>
<li><p><strong>samplingZone</strong> (<em>dict</em>) – <p>where to perform the over sampling. Dictionnaries should have the following keys:</p>
<ul>
<li><p>’where’ (type str) -&gt; either ‘all’ to perform everywhere or ‘centre’ to perform around the centre</p></li>
<li><p>’dx’    (type int) -&gt; x-axis maximum distance from the centre coordinate. A sub-array with x-axis values within [xpos-dx, xpos+dx] will be selected. If the sampling is performed everywhere, ‘dx’ does not need to be provided.</p></li>
<li><p>’dy’    (type int) -&gt; y-axis maximum distance from the centre coordinate. A sub-array with y-axis values within [ypos-dy, ypos+dy] will be selected. If the sampling is performed everywhere, ‘dy’ does not need to be provided.</p></li>
</ul>
</p></li>
<li><p><strong>skipCheck</strong> (<em>bool</em>) – whether to skip the checking part or not</p></li>
<li><p><strong>x0</strong> (<em>int</em><em> or </em><em>float</em>) – x-axis centre position. Default is None so that nx//2 will be used.</p></li>
<li><p><strong>y0</strong> (<em>int</em><em> or </em><em>float</em>) – y-axis centre position. Default is None so that ny//2 will be used.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – whether to print text on stdout or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, Y grids and the total (sky projected + PSF convolved) model of the bulge + disk decomposition</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray, 2D ndarray, 2D ndarray</p>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.Sersic2D">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">Sersic2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nx</span></em>, <em class="sig-param"><span class="n">ny</span></em>, <em class="sig-param"><span class="n">listn</span></em>, <em class="sig-param"><span class="n">listRe</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">listIe</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">listMag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">listOffset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">listInclination</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">listPA</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">combine</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fineSampling</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">samplingZone</span><span class="o">=</span><span class="default_value">{'dx': 5, 'dy': 5, 'where': 'centre'}</span></em>, <em class="sig-param"><span class="n">skipCheck</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#Sersic2D"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.Sersic2D">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Generate a (sky projected) 2D model (image) of a sum of Sersic profiles. Neither PSF smoothing, nor projections onto the sky whatsoever are applied here.</p>
<p class="rubric"><strong>How to use</strong></p>
<p>Apart from the mandatory inputs, it is necessary to provide</p>
<ul class="simple">
<li><p>an intensity at Re for each profile</p></li>
<li><p>a total magnitude value for each profile and a corresponding magnitude offset per profile (to convert from magnitudes to intensities)</p></li>
</ul>
<p><strong>fineSampling</strong> parameter can be used to rebin the data. The shape of the final image will depend on the samplingZone used</p>
<ul class="simple">
<li><p>if the sampling is performed everywhere (‘where’ keyword in <strong>samplingZone</strong> equal to ‘all’), the final image will have dimensions (<strong>nx*fineSampling</strong>, <strong>ny*fineSampling</strong>)</p></li>
<li><p>if the sampling is performed around the centre (‘where’ equal to ‘centre’), the central part is over-sampled, but needs to be binned in the end so that pixels have the same size in the central part and around. Thus, the final image will have the dimension (<strong>nx</strong>, <strong>ny</strong>).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>listn</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>float</em><em>]</em>) – list of Sersic index for each profile</p></li>
<li><p><strong>listRe</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – list of half-light radii for each profile</p></li>
<li><p><strong>nx</strong> (<em>int</em>) – size of the model for the x-axis</p></li>
<li><p><strong>ny</strong> (<em>int</em>) – size of the model for the y-axis</p></li>
<li><p><strong>combine</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to combine (sum) all the components and return a single intensity map, or to return each component separately in lists</p></li>
<li><p><strong>listIe</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – (<strong>Optional</strong>) list of intensities at re for each profile</p></li>
<li><p><strong>listInclination</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>float</em><em>]</em>) – (<strong>Optional</strong>) list of inclination of each Sersic component on the sky in degrees</p></li>
<li><p><strong>listPA</strong> (<em>list</em><em>[</em><em>int</em><em>] or </em><em>list</em><em>[</em><em>float</em><em>]</em>) – (<strong>Optional</strong>) list of position angle of each Sersic component on the sky in degrees. Generally, these values are given between -90° and +90°.</p></li>
<li><p><strong>fineSampling</strong> (<em>int</em><em>(</em><em>&gt;0</em><em>)</em>) – (<strong>Optional</strong>) fine sampling for the pixel grid used to make high resolution models. For instance, a value of 2 means that a pixel will be split into two subpixels.</p></li>
<li><p><strong>samplingZone</strong> (<em>dict</em>) – <p>(<strong>Optional</strong>) where to perform the sampling. Default is everywhere. Dictionnaries should have the following keys:</p>
<ul>
<li><p>’where’ (type str) -&gt; either ‘all’ to perform everywhere or ‘centre’ to perform around the centre</p></li>
<li><p>’dx’    (type int) -&gt; x-axis maximum distance from the centre coordinate. An sub-array with x-axis values within [xpos-dx, xpos+dx] will be selected. If the sampling is performed everywhere, ‘dx’ does not need to be provided.</p></li>
<li><p>’dy’    (type int) -&gt; y-axis maximum distance from the centre coordinate. An sub-array with y-axis values within [ypos-dy, ypos+dy] will be selected. If the sampling is performed everywhere, ‘dy’ does not need to be provided.</p></li>
</ul>
</p></li>
<li><p><strong>skipCheck</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to skip the checking part or not</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to print info on stdout or not</p></li>
<li><p><strong>x0</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) x-axis centre position. Default is None so that <strong>nx</strong>//2 will be used.</p></li>
<li><p><strong>y0</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) y-axis centre position. Default is None so that <strong>ny</strong>//2 will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>X, Y grids and the intensity map if <strong>combine</strong> is True</p></li>
<li><p>X, Y grids and a listof intensity maps for each component if <strong>combine</strong> is False</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – <ul>
<li><p>if ‘dx’ and ‘dy’ keys are not in <strong>samplingZone</strong></p></li>
<li><p>if <strong>fineSampling</strong>, <strong>nx</strong> and <strong>ny</strong> are neither int, nor np.integer</p></li>
</ul>
</p></li>
<li><p><strong>ValueError</strong> – <ul>
<li><p>if ‘where’ key value in <strong>samplingZone</strong> is neither ‘all’, nor ‘centre’</p></li>
<li><p>if nx, ny or arcsecToGrid are &lt; 0</p></li>
<li><p>if at least one n or one Re is &lt; 0</p></li>
<li><p>if <strong>fineSampling</strong> &lt; 1</p></li>
<li><p>if at least one PA is not in the range [-90, 90] deg</p></li>
<li><p>if Ie and mag and offset are None</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py function code-definition">
<dt class="sig sig-object py" id="galaxy.models.bulge2D">
<code class="sig-prename descclassname">galaxy.models.</code><code class="sig-name descname">bulge2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nx</span></em>, <em class="sig-param"><span class="n">ny</span></em>, <em class="sig-param"><span class="n">Rb</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Ib</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inclination</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">PA</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">PSF</span><span class="o">=</span><span class="default_value">{'FWHMX': 0.8, 'FWHMY': 0.8, 'name': 'Gaussian2D', 'sigmaX': None, 'sigmaY': None, 'unit': 'arcsec'}</span></em>, <em class="sig-param"><span class="n">noPSF</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">arcsecToGrid</span><span class="o">=</span><span class="default_value">0.03</span></em>, <em class="sig-param"><span class="n">fineSampling</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">samplingZone</span><span class="o">=</span><span class="default_value">{'dx': 5, 'dy': 5, 'where': 'centre'}</span></em>, <em class="sig-param"><span class="n">skipCheck</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/galaxy/models.html#bulge2D"><span class="viewcode-link">[source]</span></a><a aria-label="Click to copy this link" class="headerlink tooltipped tooltipped-ne" data-action="click-&gt;clipboard#copyHeaderLink" data-controller="clipboard" href="#galaxy.models.bulge2D">¶</a></dt>
<dd>
<p><em>Code author: Wilfried Mercier - IRAP &lt;<a class="reference external" href="mailto:wilfried.mercier%40irap.omp.eu" rel="nofollow noopener">wilfried<span>.</span>mercier<span>@</span>irap<span>.</span>omp<span>.</span>eu<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>&gt;</em></p>
<p>Generate a 2D model for a de Vaucouleur bulge. This model can be sky projected and PSF convolved.</p>
<p class="rubric"><strong>How to use</strong></p>
<p>You must provide the size of the image with <strong>nx</strong> and <strong>ny</strong> as well as a bulge effective radius (usually in pixel unit) with <strong>Rb</strong>. Additionally, one must provide one of the following</p>
<ul class="simple">
<li><p>surface brightness at <strong>Rb</strong> with <strong>Ib</strong></p></li>
<li><p>total magnitude and magnitude offset to go from magnitude to <strong>Ie</strong> using the parameters <strong>mag</strong> and <strong>offset</strong></p></li>
</ul>
<p>The PSF convolution only accepts 2D Gaussians for now. You can either provide</p>
<ul class="simple">
<li><p>a FWHM in the X and Y directions</p></li>
<li><p>a dispersion in the X and Y directions</p></li>
</ul>
<p>You must also provide a unit for the FWHM or sigma values. This unit must be recognised by astropy. Since images have dimensions in pixel unit, if the FWHM or sigma values are not given in pixel unit, you must also provide <code class="samp docutils literal notranslate">arcsecToGrid</code> to convert from physical unit to pixel unit.</p>
<p>If you do not want to convolve with the PSF, provide <code class="samp docutils literal notranslate">noPSF=True</code>.</p>
<p><strong>fineSampling</strong> parameter can be used to rebin the data. The shape of the final image will depend on the samplingZone used</p>
<ul class="simple">
<li><p>if the sampling is performed everywhere (‘where’ keyword in <strong>samplingZone</strong> equal to ‘all’), the final image will have dimensions (<strong>nx*fineSampling</strong>, <strong>ny*fineSampling</strong>)</p></li>
<li><p>if the sampling is performed around the centre (‘where’ equal to ‘centre’), the central part is over-sampled, but needs to be binned in the end so that pixels have the same size in the central part and around. Thus, the final image will have the dimension (<strong>nx</strong>, <strong>ny</strong>).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nx</strong> (<em>int</em>) – size of the model for the x-axis</p></li>
<li><p><strong>ny</strong> (<em>int</em>) – size of the model for the y-axis</p></li>
<li><p><strong>Rb</strong> (<em>float</em>) – bulge half-light radius. Best practice is to provide it in pixels.</p></li>
<li><p><strong>x0</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) x-axis centre position. Default is None so that <strong>nx</strong>//2 will be used.</p></li>
<li><p><strong>y0</strong> (<em>int</em><em> or </em><em>float</em>) – (<strong>Optional</strong>) y-axis centre position. Default is None so that <strong>ny</strong>//2 will be used.</p></li>
<li><p><strong>Ib</strong> (<em>float</em>) – (<strong>Optional</strong>) bulge intensity at (bulge) half-light radius. If not provided, magnitude and magnitude offset must be given instead.</p></li>
<li><p><strong>magB</strong> (<em>float</em>) – (<strong>Optional</strong>) bulge total magnitude</p></li>
<li><p><strong>offsetB</strong> (<em>float</em>) – (<strong>Optional</strong>) bulge magnitude offset</p></li>
<li><p><strong>inclination</strong> ((<strong>Optional</strong>) int or float) – (<strong>Optional</strong>) inclination on sky. Generally given between -90° and +90°. Value must be given in degrees.</p></li>
<li><p><strong>PA</strong> (<em>int</em><em> or </em><em>float</em>) – position angle (in degrees)</p></li>
<li><p><strong>PSF</strong> (<em>dict</em>) – (<strong>Optional</strong>) Dictionnary of the PSF (and its parameters) to use for the convolution. For now, only 2D Gaussians are accepted as PSF.</p></li>
<li><p><strong>noPSF</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to not perform PSF convolution or not</p></li>
<li><p><strong>arcsecToGrid</strong> (<em>float</em>) – (<strong>Optional</strong>) pixel size conversion in arcsec/pixel, used to convert the FWHM/sigma from arcsec to pixel</p></li>
<li><p><strong>fineSampling</strong> (<em>int</em><em>(</em><em>&gt;0</em><em>)</em>) – fine sampling for the pixel grid used to make high resolution models. For instance, a value of 2 means that a pixel will be split into two subpixels.</p></li>
<li><p><strong>samplingZone</strong> (<em>dict</em>) – <p>where to perform the over sampling. Dictionnaries should have the following keys:</p>
<ul>
<li><p>’where’ (type str) -&gt; either ‘all’ to perform everywhere or ‘centre’ to perform around the centre</p></li>
<li><p>’dx’    (type int) -&gt; x-axis maximum distance from the centre coordinate. A sub-array with x-axis values within [xpos-dx, xpos+dx] will be selected. If the sampling is performed everywhere, ‘dx’ does not need to be provided.</p></li>
<li><p>’dy’    (type int) -&gt; y-axis maximum distance from the centre coordinate. A sub-array with y-axis values within [ypos-dy, ypos+dy] will be selected. If the sampling is performed everywhere, ‘dy’ does not need to be provided.</p></li>
</ul>
</p></li>
<li><p><strong>skipCheck</strong> (<em>bool</em>) – whether to skip the checking part or not</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – (<strong>Optional</strong>) whether to print info on stdout or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X coordinate array, Y coordinate array and the 2D bulge model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D ndarray[float], 2D ndarray[float], 2D ndarray[float]</p>
</dd>
</dl>
<p class="rubric"><strong>Example</strong></p>
<p>Comparing different models:</p>
<ul class="simple">
<li><p>The first does not use <strong>fineSampling</strong>, thus it shows an intensity profile, rather than a flux profile</p></li>
<li><p>The second one uses <code class="samp docutils literal notranslate">fineSampling=81</code> so that it matches more the ouput of <a class="reference external" href="https://users.obs.carnegiescience.edu/peng/work/galfit/galfit.html" rel="nofollow noopener">Galfit<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a></p></li>
<li><p>The last one also uses <strong>fineSampling</strong> but is convolved by a Gaussian with <img alt="{\rm{FWHM}} = 0.087~\rm{arcsec}" class="math" src="../_images/math/e49ad3bf0a784e35d85765cb2194f74f74ff1d4c.png"/></p></li>
</ul>
<div class="code-wrapper" data-controller="code">
<div class="code-header">
<span class="code-lang">python</span></div>
<div class="highlight"><pre><code><span class="kn">from</span>   <span class="nn">matplotlib.colors</span>   <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">from</span>   <span class="nn">matplotlib</span>          <span class="kn">import</span> <span class="n">rc</span>
<span class="kn">from</span>   <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span>   <span class="nn">wilfried.galaxy</span>     <span class="kn">import</span> <span class="n">models</span> <span class="k">as</span> <span class="n">mod</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>   <span class="k">as</span>     <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>          <span class="k">as</span>     <span class="nn">mpl</span>

<span class="c1"># Bulge model using fine sampling and without PSF</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">bulge1</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">bulge2D</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">noPSF</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Bulge mode with fine sampling but without PSF</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">bulge2</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">bulge2D</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">noPSF</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fineSampling</span><span class="o">=</span><span class="mi">81</span><span class="p">)</span>

<span class="c1"># Bulge model with fine sampling and with PSF convolution (FWHM=0.8 arcsec)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">bulge3</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">bulge2D</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">noPSF</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fineSampling</span><span class="o">=</span><span class="mi">81</span><span class="p">,</span>
                          <span class="n">PSF</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span><span class="s1">'Gaussian2D'</span><span class="p">,</span> <span class="s1">'FWHMX'</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">'FWHMY'</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span> <span class="s1">'unit'</span><span class="p">:</span><span class="s1">'arcsec'</span><span class="p">},</span> <span class="n">arcsecToGrid</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="c1">###############################</span>
<span class="c1">#          Plot part          #</span>
<span class="c1">###############################</span>

<span class="c1"># Setup figure and axes</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'font'</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">'family'</span><span class="p">:</span> <span class="s1">'serif'</span><span class="p">,</span> <span class="s1">'serif'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Times'</span><span class="p">]})</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'text'</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'text.latex.preamble'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'\usepackage</span><span class="si">{newtxmath}</span><span class="s1">'</span>

<span class="n">f</span>            <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">gs</span>           <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">ax1</span>          <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax2</span>          <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax3</span>          <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'No fine sampling'</span><span class="p">,</span>      <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Fine sampling = $9^2$'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Fine sampling \&amp; PSF'</span><span class="p">,</span>  <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]:</span>
   <span class="n">a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
   <span class="n">a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
   <span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">'in'</span><span class="p">)</span>
   <span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">'in'</span><span class="p">)</span>
   <span class="n">a</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>
   <span class="n">a</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>

<span class="c1"># Show bulges</span>
<span class="n">ret1</span>  <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">)</span>
<span class="n">ret2</span>  <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">)</span>
<span class="n">ret3</span>  <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge3</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">cb_ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">])</span>
<span class="n">cbar</span>  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ret1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Surface brightness [arbitrary unit]'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>(<a class="reference external" href="../galaxy/models-1.py" rel="nofollow noopener">Source code<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="../galaxy/models-1.png" rel="nofollow noopener">png<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="../galaxy/models-1.hires.png" rel="nofollow noopener">hires.png<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="../galaxy/models-1.pdf" rel="nofollow noopener">pdf<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>)</p>
<figure class="align-default">
<img alt="../_images/models-1.png" class="plot-directive" src="../_images/models-1.png"/>
</figure>
<p class="rubric"><strong>Comparison with Galfit models</strong></p>
<p>We can also compare the ouput from this function with a similar model made with <a class="reference external" href="https://users.obs.carnegiescience.edu/peng/work/galfit/galfit.html" rel="nofollow noopener">Galfit<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>:</p>
<div class="code-wrapper" data-controller="code">
<div class="code-header">
<span class="code-lang">python</span></div>
<div class="highlight"><pre><code><span class="kn">from</span>   <span class="nn">matplotlib.colors</span>   <span class="kn">import</span> <span class="n">LogNorm</span><span class="p">,</span> <span class="n">Normalize</span>
<span class="kn">from</span>   <span class="nn">matplotlib</span>          <span class="kn">import</span> <span class="n">rc</span>
<span class="kn">from</span>   <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span>   <span class="nn">astropy.io</span>          <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span>   <span class="nn">wilfried.galaxy</span>     <span class="kn">import</span> <span class="n">models</span> <span class="k">as</span> <span class="n">mod</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>   <span class="k">as</span>     <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>          <span class="k">as</span>     <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">numpy</span>               <span class="k">as</span>     <span class="nn">np</span>

<span class="c1">##############################</span>
<span class="c1">#     Generate 2D models     #</span>
<span class="c1">##############################</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">bulge1</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">bulge2D</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">noPSF</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="n">fineSampling</span><span class="o">=</span><span class="mi">81</span><span class="p">,</span> <span class="n">samplingZone</span><span class="o">=</span><span class="p">{</span><span class="s1">'where'</span><span class="p">:</span><span class="s1">'centre'</span><span class="p">,</span> <span class="s1">'dx'</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'dy'</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">bulge2</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">bulge2D</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">mag</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">noPSF</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fineSampling</span><span class="o">=</span><span class="mi">81</span><span class="p">,</span> <span class="n">samplingZone</span><span class="o">=</span><span class="p">{</span><span class="s1">'where'</span><span class="p">:</span><span class="s1">'centre'</span><span class="p">,</span> <span class="s1">'dx'</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'dy'</span><span class="p">:</span><span class="mi">5</span><span class="p">},</span>
                          <span class="n">PSF</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span><span class="s1">'Gaussian2D'</span><span class="p">,</span> <span class="s1">'FWHMX'</span><span class="p">:</span><span class="mf">0.087</span><span class="p">,</span> <span class="s1">'FWHMY'</span><span class="p">:</span><span class="mf">0.087</span><span class="p">,</span> <span class="s1">'unit'</span><span class="p">:</span><span class="s1">'arcsec'</span><span class="p">},</span> <span class="n">arcsecToGrid</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>

<span class="c1">#####################################</span>
<span class="c1">#     Load GALFIT output images     #</span>
<span class="c1">#####################################</span>

<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">'/home/wilfried/wilfried_libs/galaxy/.test/bulge_withoutPSF.fits'</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
   <span class="n">bulge_nopsf</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">'/home/wilfried/wilfried_libs/galaxy/.test/bulge_withPSF.fits'</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
   <span class="n">bulge_psf</span>   <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1">##########################</span>
<span class="c1">#       Plot parts       #</span>
<span class="c1">##########################</span>

<span class="n">rc</span><span class="p">(</span><span class="s1">'font'</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">'family'</span><span class="p">:</span> <span class="s1">'serif'</span><span class="p">,</span> <span class="s1">'serif'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Times'</span><span class="p">]})</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'text'</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">'text.latex.preamble'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'\usepackage</span><span class="si">{newtxmath}</span><span class="s1">'</span>

<span class="n">f</span>            <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">gs</span>           <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>

<span class="n">axs</span>          <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gs</span><span class="p">:</span>
   <span class="n">axs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'without PSF'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'bulge2D'</span><span class="p">,</span>      <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Galfit bulge'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Residuals'</span><span class="p">,</span>    <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'with PSF'</span><span class="p">,</span>    <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>


<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
   <span class="n">a</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
   <span class="n">a</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>

   <span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">'in'</span><span class="p">)</span>
   <span class="n">a</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">'both'</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">'in'</span><span class="p">)</span>
   <span class="n">a</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>
   <span class="n">a</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'both'</span><span class="p">)</span>

<span class="c1"># First line</span>
<span class="n">mmax</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">bulge1</span><span class="p">,</span> <span class="n">bulge2</span><span class="p">,</span> <span class="n">bulge_nopsf</span><span class="p">,</span> <span class="n">bulge_psf</span><span class="p">])</span>
<span class="n">mmin</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">bulge1</span><span class="p">,</span> <span class="n">bulge2</span><span class="p">,</span> <span class="n">bulge_nopsf</span><span class="p">,</span> <span class="n">bulge_psf</span><span class="p">])</span>

<span class="n">diff1</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="mi">100</span><span class="o">*</span><span class="n">bulge_nopsf</span><span class="o">/</span><span class="n">bulge1</span>
<span class="n">diff2</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="mi">100</span><span class="o">*</span><span class="n">bulge_psf</span><span class="o">/</span><span class="n">bulge2</span>
<span class="n">dmax</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">([</span><span class="n">diff1</span><span class="p">,</span> <span class="n">diff2</span><span class="p">])</span>
<span class="n">dmin</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">([</span><span class="n">diff1</span><span class="p">,</span> <span class="n">diff2</span><span class="p">])</span>

<span class="n">ret11</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge1</span><span class="p">,</span>      <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">,</span>  <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span>  <span class="n">vmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">))</span>
<span class="n">ret12</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge_nopsf</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">,</span>  <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span>  <span class="n">vmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">))</span>
<span class="n">ret13</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diff1</span><span class="p">,</span>       <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'viridis'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">dmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">dmax</span><span class="p">))</span>

<span class="c1"># Second line</span>
<span class="n">ret21</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge2</span><span class="p">,</span>      <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">,</span>  <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span>  <span class="n">vmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">))</span>
<span class="n">ret22</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bulge_psf</span><span class="p">,</span>   <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'plasma'</span><span class="p">,</span>  <span class="n">norm</span><span class="o">=</span><span class="n">LogNorm</span><span class="p">(</span>  <span class="n">vmin</span><span class="o">=</span><span class="n">mmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">mmax</span><span class="p">))</span>
<span class="n">ret23</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">diff2</span><span class="p">,</span>       <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'viridis'</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">dmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">dmax</span><span class="p">))</span>

<span class="c1"># Add colorbar 1</span>
<span class="n">cb_ax1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">])</span>
<span class="n">cbar1</span>  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ret11</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax1</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">)</span>
<span class="n">cbar1</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Surface brightness [arbitrary unit]'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">cbar1</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Add colorbar 2</span>
<span class="n">cb_ax2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.26</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">])</span>
<span class="n">cbar2</span>  <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ret13</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cb_ax2</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">)</span>
<span class="n">cbar2</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Relative difference (\%)'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">cbar2</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p>(<a class="reference external" href="../galaxy/models-2.py" rel="nofollow noopener">Source code<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="../galaxy/models-2.png" rel="nofollow noopener">png<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="../galaxy/models-2.hires.png" rel="nofollow noopener">hires.png<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>, <a class="reference external" href="../galaxy/models-2.pdf" rel="nofollow noopener">pdf<svg aria-hidden="true" class="external-link-icon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 19H5V5h7V3H5a2 2 0 00-2 2v14a2 2 0 002 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"></path></svg></a>)</p>
<figure class="align-default">
<img alt="../_images/models-2.png" class="plot-directive" src="../_images/models-2.png"/>
</figure>
</dd></dl>
</section>
</section>
</article>
<footer>
<div class="mt-20 mb-4 text-sm text-gray-700">© 2022, Wilfried Mercier Made with <a href="https://www.sphinx-doc.org">Sphinx 4.4.0</a></div>
</footer></main>
<button class="fixed bottom-0 right-0 z-20 opacity-0 p-4 m-4 tracking-wide bg-gray-900 text-gray-100 transition transform transform-gpu duration-500 translate-y-full" data-action="search#hideSnackbar" data-search-target="snackbar">
  Clear highlights
</button><div class="fixed hidden inset-0 bg-black bg-opacity-50" data-action="click-&gt;sidebar#close" data-sidebar-target="screen">
</div>
</div>
<script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
<script src="../_static/jquery.js"></script>
<script src="../_static/underscore.js"></script>
<script src="../_static/doctools.js"></script>
<script src="../_static/clipboard.min.js"></script>
<script src="../_static/copybutton.js"></script>
<script src="../_static/theme.3666d2347a4c66e5d7a8.js"></script>
</body>
</html>